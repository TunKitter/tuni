(()=>{"use strict";var e={741:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.getComponent)(".input_form_wrapper.action_wrapper",!1);return{addNewAction:()=>o(e),getElement:()=>e,onAddNewAction:t=>{e.querySelector("#tunkit_add_new_action").onclick=()=>{const n=o(e);t(n)}}}};const i=n(666);function o(e){const t=(0,i.getComponent)(".tunkit_btn_action_item",!1);return t.querySelector(".tunkit_btn_action_icon").src=(0,i._getURL)("icons/notification.svg"),e.querySelector(".tunkit_action_wrapper").appendChild(t),{getElement:()=>t,onClick:e=>{t.addEventListener("click",(()=>e()))},setIcon(e){t.querySelector(".tunkit_btn_action_icon").src=(0,i._getURL)(`icons/${e}.svg`)},setName(e){t.querySelector(".tunkit_btn_action_name").textContent=e}}}},462:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.getComponent)(".tunkit_input_tags_wrapper",!1),t=e.querySelector("#tunkit_input_type_folder"),n=e.querySelector("#tunkit_list_folder");let l=[];return e.addEventListener("click",(()=>t.focus())),t.addEventListener("keyup",(function(e){let i=t.value;"Enter"===e.key&&i.length>0&&!l.includes(i)&&(l.push(i),o(n,l,i),t.value="")})),{getElement:()=>e,setData:function(e){!function(e,t){e.querySelectorAll("li:not(#tunkit_input_type_folder_li)").forEach((e=>e.remove())),t.forEach((n=>{o(e,t,n)}))}(n,e),l=e},getData:()=>l}};const i=n(666);function o(e,t,n){const o=document.createElement("li");o.innerText=n;const l=(0,i.getComponent)(".tunkit_close_icon_input_tags_wrapper",!1);o.prepend(l),e.appendChild(o),l.addEventListener("click",(function(){t.splice(t.indexOf(n),1),o.remove()}))}},863:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseTimelineDialog=function(){const e=(0,l.getComponent)(".tunkit_timeline_note.base_timeline_dialog",!1),t=(0,o.default)();(0,l.insertAdjacentElement)(e,t.getElement(),".tunkit_base_info_wrapper");const n=e.querySelector(".tunkit_timeline_note_name"),i=e.querySelector(".tunkit_input_time.time_start"),r=e.querySelector(".tunkit_input_time.time_end");return{render(){a.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block"},INPUT_TAG:t,getElement:()=>e,getName:()=>n.value,getStartTime:()=>(0,l.HmsToSeconds)(i.value),getEndTime:()=>(0,l.HmsToSeconds)(r.value),setTitle(t){e.querySelector("#tunkit_title_timeline").innerText=t},setName(e){n.value=e},setStartTime(e){i.value=(0,l.secondsToHms)(String(e))},setEndTime(e){r.value=(0,l.secondsToHms)(String(e))},onClickSave(t){e.querySelector(".tunkit_save_timeline_btn").onclick=()=>t()},onClickDelete(t){e.querySelector(".delete_timeline_button").onclick=()=>t()}}};const o=i(n(462)),l=n(666),a=i(n(934))},73:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageTimelineDialog=function(){const e=(0,a.getBaseTimelineDialog)(),t=(0,l.getComponent)(".panel_timeline_message",!1),n=t.querySelector(".tunkit_timeline_message"),i=(0,o.default)();return(0,l.insertAdjacentElement)(e.getElement(),t,".tunkit_input_tags_wrapper"),(0,l.insertAdjacentElement)(e.getElement(),i.getElement(),".panel_timeline_message"),{BASE:e,BUTTON_ADDER:i,render(){e.render()},getDataTimeline:()=>n.value,setDataTimeline(e){n.value=e}}};const o=i(n(741)),l=n(666),a=n(863)},618:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getTemplateDialogComponent=function(){const e=(0,o.getComponent)(".tunkit_template",!1),t=e.querySelector(".tunkit_template_name"),n=e.querySelector(".tunkit_template_description");return{render(){l.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block"},getName:()=>t.value,getDescription:()=>n.value,getElement:()=>e,setName(e){t.value=e},setDescription(e){n.value=e},onClickClose(t){e.querySelector(".tunkit_close_template").onclick=()=>t()},onClickSubmit(t){e.querySelector(".tunkit_save_template").onclick=()=>t()},onClickDelete(t){e.querySelector(".tunkit_delete_template").onclick=()=>t()}}};const o=n(666),l=i(n(934))},328:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdateActionDialog=function(){const e=(0,l.getComponent)(".tunkit_detail_timeline_note",!1),t=e.querySelector(".tunkit_action_name");return(0,o.handleShowPanel)(e,((e,t)=>t())),function(e){var t;null===(t=e.querySelector("#tunkit_select_action_type"))||void 0===t||t.addEventListener("change",(function(){var t;null===(t=e.querySelector(`#tunkit_action_${this.value}_hidden`))||void 0===t||t.click()}))}(e),{render(){a.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block"},getActionName:()=>t.value,setActionName:e=>t.value=e,getElement:()=>e,getType:()=>e.querySelector("#tunkit_select_action_type").value,getData:function(){return r(this.getType(),e)},setData:(t,n)=>{setTimeout((()=>{var n;null===(n=e.querySelector(`#tunkit_action_${t}_hidden`))||void 0===n||n.click()}),0),e.querySelector("#tunkit_select_action_type").value=t,r(t,e,n)},onClickClose:function(t){e.querySelector(".tunkit_close_action_button").onclick=()=>t()},onClickUpdate:function(t){e.querySelector(".save_action_button").onclick=()=>t()},onClickDelete:function(t){e.querySelector(".delete_action_button").onclick=()=>t()}}};const o=n(221),l=n(666),a=i(n(934));function r(e,t,n=void 0){switch(e){case"notification":{const e=t.querySelector(".tunkit_action_notification_content");if("string"!=typeof n&&void 0!==n)throw new Error("Data must be string on Notification action");if(void 0===n)return e.value;e.value=n;break}case"jump_timeline":{const e=t.querySelector(".tunkit_action_jump_timeline_content"),i=t.querySelector(".tunkit_jump_timeline_message");if("object"!=typeof n&&void 0!==n)throw new Error("Data must be string on Jump timeline action");if(void 0===n)return{message:i.value,timeline:(0,l.HmsToSeconds)(e.value)};e.value=(0,l.secondsToHms)(String(n.timeline)),i.value=n.message;break}case"mark_correct":case"mark_incorrect":if(void 0===n)return!0}}},996:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonAdderWithDialogActionFlow=function(e,t){Object.keys(e).forEach((n=>{const i=t.BUTTON_ADDER.addNewAction();i.setName(e[n].name),i.setIcon(e[n].type),i.onClick((()=>a(e,n,i)))})),t.BUTTON_ADDER.onAddNewAction((function(t){const n=(0,o.randomString)();e[n]={name:"No title",type:"notification",data:"Enter you notification here"},t.onClick((()=>a(e,n,t)))}))};const i=n(328),o=n(666),l=n(195);function a(e,t,n){const o=(0,i.getUpdateActionDialog)();o.setActionName(e[t].name),o.setData(e[t].type,e[t].data);const a=(0,l.DialogWithOverlayFlow)(o.getElement(),{close_selector:[".tunkit_close_action_button"],overlay_z_index:2202});o.onClickUpdate((function(){e[t]={name:o.getActionName(),type:o.getType(),data:o.getData()},a.removeDialog(),a.removeOverlay(),n.setName(e[t].name),n.setIcon(e[t].type)})),o.onClickDelete((function(){confirm("Are you sure want to delete this action?")&&(delete e[t],n.getElement().remove(),a.removeDialog(),a.removeOverlay())})),o.render()}},195:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DialogWithOverlayFlow=function(e,t){var n;let o=null!=(null==t?void 0:t.overlay_z_index)?(0,i.getFullOverlay)(t.overlay_z_index):null;return null==o||o.render(),null===(n=t.close_selector)||void 0===n||n.map((t=>{e.querySelector(t).addEventListener("click",(function(){var t;e.remove(),null===(t=null==o?void 0:o.getElement())||void 0===t||t.remove()}))})),{removeOverlay:()=>{var e;return null===(e=null==o?void 0:o.getElement())||void 0===e?void 0:e.remove()},removeDialog:()=>e.remove()}};const i=n(827)},879:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,l){function a(e){try{u(i.next(e))}catch(e){l(e)}}function r(e){try{u(i.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(433),a=o(n(500)),r=n(221),u=n(262);new MutationObserver(((e,t)=>i(void 0,void 0,void 0,(function*(){"complete"===document.readyState&&!document.querySelector("#tunkit_interactive_button")&&document.querySelector(".ytp-subtitles-button.ytp-button")&&((0,l.insertToggleIconMenu)(),yield(0,l.insertComponent)(),(0,l.insertMenuPanel)(),(0,r.handleToggleMenuSwitcherIcon)(),(0,l.handelTogglePanel)(),(0,r.handleChangeViewPanel)(),(0,u.handleCreateTemplatePanel)(),(0,a.default)(),t.disconnect())})))).observe(document,{childList:!0,subtree:!0})},433:function(e,t,n){var i,o=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,o)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),l=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),a=0;a<n.length;a++)"default"!==n[a]&&o(t,e,n[a]);return l(t,e),t}),r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,l){function a(e){try{u(i.next(e))}catch(e){l(e)}}function r(e){try{u(i.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.component_wrapper=void 0,t.insertToggleIconMenu=function(){const e=document.querySelector(".ytp-subtitles-button.ytp-button");if(null==e)throw new Error("Can't insert trigger button");const t=document.createElement("button");t.classList.add("ytp-button"),t.id="tunkit_interactive_button",t.innerHTML=`<img id="tunkit_svg" aria-pressed="false" class="ytp-svg-shadow" src="${(0,u._getURL)("icons/panel_icon.svg")}"/>`,e.insertAdjacentElement("afterend",t)},t.insertComponent=function(){return r(this,void 0,void 0,(function*(){yield fetch((0,u._getURL)("static/bundle.html")).then((e=>e.text())).then((function(e){const n=(0,u._getURL)("icons/");e=e.replaceAll(/{{icon\./g,n).replaceAll("}}",".svg"),t.component_wrapper.innerHTML=e,(0,c.initAfterInsertComponent)()}))}))},t.insertMenuPanel=function(){var e;null===(e=document.querySelector(".ytp-popup.ytp-settings-menu"))||void 0===e||e.insertAdjacentElement("afterend",c.default.PANEL_WRAPPER)},t.handelTogglePanel=function(){const e=document.querySelector("#tunkit_interactive_button");if(null==e)throw new Error("Can't find trigger button");e.addEventListener("click",(()=>c.default.PANEL_WRAPPER.classList.toggle("tunkit_menu_active")))};const u=n(666),c=a(n(934));t.component_wrapper=document.createElement("div")},834:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(666);t.default=class{static from(e){return{getAll(){const t=(0,i.getTitleYoutube)();return chrome.runtime.sendMessage({type:"GET_ALL_TEMPLATE",youtubeID:e,title:t})},get:t=>chrome.runtime.sendMessage({type:"GET_TEMPLATE",youtubeID:e,id:t}),insert(t){const n=(0,i.randomString)();return chrome.runtime.sendMessage({type:"INSERT_TEMPLATE",youtubeID:e,id:n,data:t}).then((()=>({status:"success",id:n})))},remove:t=>chrome.runtime.sendMessage({type:"REMOVE_TEMPLATE",youtubeID:e,id:t}),update:(t,n)=>chrome.runtime.sendMessage({type:"UPDATE_TEMPLATE",youtubeID:e,id:t,data:n})}}}},103:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(666),l=i(n(834));class a{static from(e){return{withTemplate:t=>({insert(n){const i=(0,o.randomString)();return l.default.from(e).get(t).then((o=>{o.timelineNotes[i]=n;const a=Date.now();return o.timelineNotes[i].created_at=a,o.timelineNotes[i].updated_at=a,l.default.from(e).update(t,{timelineNotes:o.timelineNotes}).then((function(e){return{status:e.status,id:i}}))}))},update:(n,i)=>l.default.from(e).get(t).then((o=>{var a;if(null==(null===(a=null==o?void 0:o.timelineNotes)||void 0===a?void 0:a[n]))throw new Error("Timeline not found");return o.timelineNotes[n]=i,o.timelineNotes[n].updated_at=Date.now(),l.default.from(e).update(t,{timelineNotes:o.timelineNotes}).then((function(e){return{status:e.status}}))})),remove:n=>l.default.from(e).get(t).then((i=>{var o;if(null==(null===(o=null==i?void 0:i.timelineNotes)||void 0===o?void 0:o[n]))throw new Error("Timeline not found");return delete i.timelineNotes[n],l.default.from(e).update(t,{timelineNotes:i.timelineNotes}).then((function(e){return{status:e.status}}))}))})}}}a.GETNAME={message:"Message",flashcard:"Flashcard",typing:"Typing",pointer:"Pointer"},t.default=a},500:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){navigation.addEventListener("navigate",(()=>{var e;null===(e=l.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),(0,o.showPanel)(".tunkit_panel.panel_main","tunkit_panel_active"),l.default.IS_GET_TEMPLATE=!1,(0,o.setDisableItems)(l.default.PANEL_WRAPPER,".tunkit_disable_for_template",!0),(0,o.setCurrentTemplate)("Off"),(0,o.setCurrentTotalNotes)("Off"),l.default.IS_GET_TIMELINE=!1,l.default.CURRENT_TEMPLATE_ID=null,l.default.TIMELINE_NOTE={},l.default.FULL_OVERLAY_WRAPPER.innerHTML="",l.default.DIALOG_WRAPPER.innerHTML=""}))};const o=n(221),l=i(n(934))},827:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFullOverlay=function(e){const t=o.default.FULL_OVERLAY.cloneNode(!0);return e&&(t.style.zIndex=String(e)),{render(){o.default.FULL_OVERLAY_WRAPPER.appendChild(t)},getElement:()=>t}};const o=i(n(934))},221:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleShowPanel=_,t.handleChangeViewPanel=function(){_(c.default.PANEL_WRAPPER,(function(e,t){if(0!=f())switch(e.dataset.tunkitPanel){case"main":t();break;case"template":if(t(),c.default.IS_GET_TEMPLATE)break;(0,s.handleLoadTemplate)(),c.default.IS_GET_TEMPLATE=!0;break;case"note":if(!c.default.CURRENT_TEMPLATE_ID)break;if(t(),c.default.IS_GET_TIMELINE)break;(0,d.handleLoadTimeline)(),c.default.IS_GET_TIMELINE=!0;break;case"create_message_timeline":if(!c.default.CURRENT_TEMPLATE_ID)return;!function(){var e;const t=(0,o.getMessageTimelineDialog)(),n=(0,a.DialogWithOverlayFlow)(t.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201});t.BASE.setTitle("Create message timeline"),t.BASE.setStartTime(c.default.VIDEO.currentTime),t.BASE.setEndTime(c.default.VIDEO.currentTime+5),null===(e=t.BASE.getElement().querySelector(".delete_timeline_button"))||void 0===e||e.remove();const i={};(0,l.ButtonAdderWithDialogActionFlow)(i,t),t.render(),t.BASE.onClickSave((function(){const e={name:t.BASE.getName(),startTime:t.BASE.getStartTime(),endTime:t.BASE.getEndTime(),tags:t.BASE.INPUT_TAG.getData(),data:t.getDataTimeline(),action:i,type:"message",timeline:(0,u.getTimelineTextFormat)(t.BASE.getStartTime(),t.BASE.getEndTime())};r.default.from((0,u.getCurrentYoutubeId)()).withTemplate(c.default.CURRENT_TEMPLATE_ID).insert(e).then((t=>{if("success"==t.status){c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes[t.id]=e;const i=(0,d.getTimelinePanelItem)();i.setTimelineText(e.startTime,e.endTime),i.setName(e.name),i.setType(e.type),i.onClick((()=>(0,d.handleClickTimelineItemPanel)(t.id,i))),i.render(),n.removeDialog(),n.removeOverlay(),c.default.IS_GET_TEMPLATE=!1,p(Object.keys(c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes).length)}}))}))}();break;case"create_flashcard_timeline":if(!c.default.CURRENT_TEMPLATE_ID)return}}))},t.showPanel=m,t.handleToggleMenuSwitcherIcon=function(){var e,t;null===(t=null===(e=c.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_toggle_interactive_video"))||void 0===t||t.addEventListener("click",(function(){E(!f())}))},t.setActivePanel=E,t.getActivePanel=f,t.setDisableItems=function(e,t,n){e.querySelectorAll(t).forEach((e=>{e.style.opacity=n?"0.5":"1"}))},t.setCurrentTemplate=function(e){var t;null===(t=c.default.PANEL_WRAPPER)||void 0===t||(t.querySelector(".tunkit_current_template").textContent=e)},t.setCurrentTotalNotes=p;const o=n(73),l=n(996),a=n(195),r=i(n(103)),u=n(666),c=i(n(934)),s=n(262),d=n(851);function _(e,t=void 0){e.querySelectorAll("*[data-tunkit-panel]").forEach((e=>{e.addEventListener("click",(function(){void 0!==t&&t(e,(function(){m(".tunkit_panel.panel_"+e.dataset.tunkitPanel,e.dataset.tunkitType)}))}))}))}function m(e,t,n=document){var i,o,l,a;null===(o=null===(i=n.querySelector("."+t))||void 0===i?void 0:i.classList)||void 0===o||o.remove(t),null===(a=null===(l=n.querySelector(e))||void 0===l?void 0:l.classList)||void 0===a||a.add(t)}function E(e){var t,n;(null===(t=c.default.PANEL_WRAPPER)||void 0===t?void 0:t.querySelector("#tunkit_toggle_interactive_video")).setAttribute("aria-checked",e?"true":"false"),(null===(n=c.default.PANEL_WRAPPER)||void 0===n?void 0:n.querySelector(".tunkit_content")).style.opacity=e?"1":"0.5"}function f(){var e;return"true"==(null===(e=c.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_toggle_interactive_video")).getAttribute("aria-checked")}function p(e){var t;null===(t=c.default.PANEL_WRAPPER)||void 0===t||(t.querySelector(".tunkit_total_notes").innerText="number"==typeof e?`${e} note${e>1?"s":""}`:e)}},262:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(o,l){function a(e){try{u(i.next(e))}catch(e){l(e)}}function r(e){try{u(i.throw(e))}catch(e){l(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleLoadTemplate=function(){return i(this,void 0,void 0,(function*(){var e;const t=null===(e=c.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_loader.loader_template");t.style.display="block",c.default.TEMPLATE_PANEL_WRAPPER.innerHTML="";const n=yield r.default.from((0,u.getCurrentYoutubeId)()).getAll();c.default.TIMELINE_NOTE=n,Object.keys(n).forEach((e=>{const t=d();t.setName(c.default.TIMELINE_NOTE[e].name),t.setTotalNotes(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),_(e,t),t.render()})),t.style.display="none"}))},t.getTemplateItemComponent=d,t.handleCreateTemplatePanel=function(){c.default.PANEL_WRAPPER.querySelector(".create_new_template_btn").onclick=function(){var e;const t=(0,l.getTemplateDialogComponent)(),n=(0,a.DialogWithOverlayFlow)(t.getElement(),{close_selector:[".tunkit_close_template"],overlay_z_index:2201});null===(e=t.getElement().querySelector(".tunkit_title_template_dialog"))||void 0===e||(e.innerText="Create Template"),t.getElement().querySelector(".tunkit_delete_template").remove(),t.render(),t.onClickSubmit((function(){const e={name:t.getName(),description:t.getDescription(),timelineNotes:{}};r.default.from((0,u.getCurrentYoutubeId)()).insert(e).then((t=>{if("success"==t.status&&t.id){c.default.TIMELINE_NOTE[t.id]=e;const i=d();i.setName(e.name),i.setTotalNotes(0),_(t.id,i),i.getElement().querySelector(".ytp-menuitem-label").innerHTML+=' <sup class="tunkit_new_template">new</sup>',i.getElement().addEventListener("click",(function(){i.setName(e.name)}),{once:!0}),c.default.TEMPLATE_PANEL_WRAPPER.prepend(i.getElement()),n.removeDialog(),n.removeOverlay()}}))}))}};const l=n(618),a=n(195),r=o(n(834)),u=n(666),c=o(n(934)),s=n(221);function d(){const e=(0,u.getComponent)(".tunkit_template_panel_item",!1),t=e.querySelector(".tunkit_template_panel_item_name"),n=e.querySelector(".tunkit_template_panel_item_total_note");return{render(){c.default.TEMPLATE_PANEL_WRAPPER.appendChild(e)},setName(e){t.textContent=e},setTotalNotes(e){n.textContent=`${e} note${e>1?"s":""}`},getElement:()=>e,onClickDetail(t){e.querySelector(".tunkit_template_icon_detail").onclick=function(e){e.stopPropagation(),t()}},onClick(t){e.onclick=()=>t()}}}function _(e,t){t.onClickDetail((function(){const n=(0,l.getTemplateDialogComponent)();n.setName(c.default.TIMELINE_NOTE[e].name),n.setDescription(c.default.TIMELINE_NOTE[e].description),n.render();const i=(0,a.DialogWithOverlayFlow)(n.getElement(),{close_selector:[".tunkit_close_template"],overlay_z_index:2201});n.onClickSubmit((function(){r.default.from((0,u.getCurrentYoutubeId)()).update(e,{name:n.getName(),description:n.getDescription()}).then((o=>{"success"==o.status&&(c.default.TIMELINE_NOTE[e].name=n.getName(),c.default.TIMELINE_NOTE[e].description=n.getDescription(),t.setName(n.getName()),c.default.CURRENT_TEMPLATE_ID==e&&(0,s.setCurrentTemplate)(n.getName()),i.removeOverlay(),i.removeDialog())}))})),n.onClickDelete((()=>{c.default.CURRENT_TEMPLATE_ID!=e?confirm("Are you sure you want to delete this template?")&&r.default.from((0,u.getCurrentYoutubeId)()).remove(e).then((n=>{"success"==n.status&&(delete c.default.TIMELINE_NOTE[e],i.removeOverlay(),i.removeDialog(),t.getElement().remove())})):alert("Please select another template before deleting")}))})),t.onClick((function(){var n,i,o;c.default.CURRENT_TEMPLATE_ID!=e&&(c.default.CURRENT_TEMPLATE_ID=e,null===(o=null===(i=null===(n=c.default.TEMPLATE_PANEL_WRAPPER)||void 0===n?void 0:n.querySelector(".tunkit_template_panel_item_selected"))||void 0===i?void 0:i.classList)||void 0===o||o.remove("tunkit_template_panel_item_selected"),t.getElement().classList.add("tunkit_template_panel_item_selected"),(0,s.setCurrentTemplate)(c.default.TIMELINE_NOTE[e].name),(0,s.setCurrentTotalNotes)(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),(0,s.showPanel)(".tunkit_panel.panel_main","tunkit_panel_active"),(0,s.setDisableItems)(c.default.PANEL_WRAPPER,".tunkit_disable_for_template",!1),(0,s.setCurrentTotalNotes)(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),c.default.IS_GET_TIMELINE=!1)}))}},851:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleLoadTimeline=function(){var e;const t=null===(e=c.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_loader.loader_note");t.style.display="block",c.default.TIMELINE_PANEL_WRAPPER.innerHTML="";const n=c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes;Object.keys(n).forEach((e=>{const t=d();t.setName(n[e].name),t.setTimelineText(n[e].startTime,n[e].endTime),t.setType(n[e].type),t.onClick((()=>_(e,t))),t.render()})),t.style.display="none"},t.getTimelinePanelItem=d,t.handleClickTimelineItemPanel=_;const o=n(73),l=n(996),a=n(195),r=i(n(103)),u=n(666),c=i(n(934)),s=n(221);function d(){const e=(0,u.getComponent)(".tunkit_timeline_panel_item",!1),t=e.querySelector(".timeline_panel_item_time_text"),n=e.querySelector(".timeline_panel_item_name"),i=e.querySelector(".timeline_panel_item_type");return{render(){var t;null===(t=c.default.TIMELINE_PANEL_WRAPPER)||void 0===t||t.appendChild(e)},setTimelineText(n,i){const o=(0,u.getTimelineTextFormat)(n,i);e.querySelector(".timeline_panel_item_time_text").onclick=function(e){e.stopPropagation(),c.default.VIDEO.currentTime=n},t.textContent=o},setName(e){n.textContent=e},setType(e){i.textContent=r.default.GETNAME[e]},onClick(t){e.onclick=()=>t()},getElement:()=>e}}function _(e,t){const n=c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes[e],i=(0,o.getMessageTimelineDialog)(),d=(0,a.DialogWithOverlayFlow)(i.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201});i.BASE.setTitle("Update message timeline"),i.BASE.setName(n.name),i.BASE.setStartTime(n.startTime),i.BASE.setEndTime(n.endTime),i.BASE.INPUT_TAG.setData(n.tags),i.setDataTimeline(n.data);const _=JSON.parse(JSON.stringify(n.action));(0,l.ButtonAdderWithDialogActionFlow)(_,i),i.render(),i.BASE.onClickDelete((function(){confirm("Are you sure to delete this timeline note?")&&r.default.from((0,u.getCurrentYoutubeId)()).withTemplate(c.default.CURRENT_TEMPLATE_ID).remove(e).then((n=>{"success"==n.status&&(delete c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes[e],t.getElement().remove(),c.default.IS_GET_TEMPLATE=!1,(0,s.setCurrentTotalNotes)(Object.keys(c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes).length),d.removeDialog(),d.removeOverlay())}))})),i.BASE.onClickSave((function(){const n={name:i.BASE.getName(),startTime:i.BASE.getStartTime(),endTime:i.BASE.getEndTime(),tags:i.BASE.INPUT_TAG.getData(),data:i.getDataTimeline(),action:_,type:"message",timeline:(0,u.getTimelineTextFormat)(i.BASE.getStartTime(),i.BASE.getEndTime())};r.default.from((0,u.getCurrentYoutubeId)()).withTemplate(c.default.CURRENT_TEMPLATE_ID).update(e,n).then((i=>{"success"==i.status&&(t.setTimelineText(n.startTime,n.endTime),t.setName(n.name),t.setType(n.type),c.default.TIMELINE_NOTE[c.default.CURRENT_TEMPLATE_ID].timelineNotes[e]=n,d.removeDialog(),d.removeOverlay())}))}))}},666:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._getURL=function(e){return chrome.runtime.getURL(`assets/${e}`)},t.getComponent=function(e,t=!0){const n=i.component_wrapper.querySelector(`${e}`);if(null==n)throw new Error("Can't find component");const o=n.cloneNode(!0);return 1==t&&n.remove(),o},t.randomString=function(){return"_"+(Date.now()+Math.random()+1).toString(36).replaceAll(".","")},t.getCurrentYoutubeId=function(){const e=new URLSearchParams(window.location.search).get("v");if(null==e)throw new Error("Can't get youtubeID");return e},t.getTitleYoutube=function(){var e;const t=null===(e=document.querySelector("#title > h1 > yt-formatted-string"))||void 0===e?void 0:e.textContent;if(null==t)throw new Error("Can't get youtube title");return t},t.HmsToSeconds=function(e){let t=e.split(":");return 3!=t.length?60*parseInt(t[0])+parseInt(t[1]):3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2])},t.secondsToHms=o,t.insertAdjacentElement=function(e,t,n){const i=e.querySelector(n);if(null==i)throw new Error("The element does not exists");i.insertAdjacentElement("afterend",t)},t.getTimelineTextFormat=function(e,t){return`${o(String(e))} — ${o(String(t))}`};const i=n(433);function o(e){let t=parseInt(e,10),n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),o=t-3600*n-60*i;return n<10?n="0"+n+":":n+=":",i<10&&(i="0"+i),o<10&&(o="0"+o),n+i+":"+o}},934:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAfterInsertComponent=function(){var e;if(o.PANEL_WRAPPER=(0,i.getComponent)(".tunkit_panel_wrapper"),o.TEMPLATE_PANEL_WRAPPER=null===(e=o.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector(".tunkit_template_wrapper"),o.TIMELINE_PANEL_WRAPPER=o.PANEL_WRAPPER.querySelector(".tunkit_body_note"),o.FULL_OVERLAY_WRAPPER.className="tunkit_overlay_wrapper",document.body.insertAdjacentElement("afterend",o.FULL_OVERLAY_WRAPPER),o.FULL_OVERLAY.className="tunkit_overlay opened",o.FULL_OVERLAY.style.zIndex="2201",o.DIALOG_WRAPPER.className="tunkit_dialog_wrapper",document.body.insertAdjacentElement("afterend",o.DIALOG_WRAPPER),o.VIDEO=document.querySelector("video"),null==o.VIDEO)throw new Error("Can not find video element")};const i=n(666),o={PANEL_WRAPPER:null,IS_GET_TEMPLATE:!1,IS_GET_TIMELINE:!1,TEMPLATE_PANEL_WRAPPER:null,TIMELINE_PANEL_WRAPPER:null,FULL_OVERLAY_WRAPPER:document.createElement("div"),FULL_OVERLAY:document.createElement("tp-yt-iron-overlay-backdrop"),DIALOG_WRAPPER:document.createElement("div"),CURRENT_TEMPLATE_ID:null,TIMELINE_NOTE:{},VIDEO:null};t.default=o}},t={};!function n(i){var o=t[i];if(void 0!==o)return o.exports;var l=t[i]={exports:{}};return e[i].call(l.exports,l,l.exports,n),l.exports}(879)})();