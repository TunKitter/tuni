(()=>{"use strict";var e={174:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getActionButtons=function(){const e=document.createElement("div");e.className="tunkit_timeline_interface tunkit_timeline_action_wrapper";let t={};return{render(){o.default.VIDEO_PLAYER.appendChild(e)},show(){e.style.bottom="0"},hide(){e.style.bottom="-100%"},getActionData:()=>t,setActionData(e){Object.keys(t).forEach((e=>{t[e].element.remove()})),t={},Object.keys(e).forEach((t=>{switch(e[t].type){case"notification":this.addNotificationAction(t,e[t]);break;case"jump_timeline":this.addJumpTimelineAction(t,e[t]);break;case"reference_note":this.addReferenceNoteAction(t,e[t]);break;case"mark_correct":this.addMarkCorrectAction(t,e[t]);break;case"mark_incorrect":this.addMarkIncorrectAction(t,e[t])}}))},getElement:()=>e,addNotificationAction(n,i){const o=document.createElement("div");o.className="tunkit_action_interface tunkit_action_notification_interface",o.innerHTML=`<img src="${(0,l._getURL)("icons/notification_white.svg")}"/> ${i.name}`,e.appendChild(o),t[n]={element:o,data:i}},addJumpTimelineAction(n,i){const o=document.createElement("div");o.className="tunkit_action_interface tunkit_action_jump_timeline_interface",o.innerHTML=`<img src="${(0,l._getURL)("icons/jump_timeline_white.svg")}"> ${i.name}`,e.appendChild(o),t[n]={element:o,data:i}},addReferenceNoteAction(n,i){const o=document.createElement("div");o.className="tunkit_action_interface tunkit_action_reference_note_interface",o.innerHTML=`<img src="${(0,l._getURL)("icons/reference_note_white.svg")}"> ${i.name}`,e.appendChild(o),t[n]={element:o,data:i}},addMarkCorrectAction(n,i){const o=document.createElement("div");o.className="tunkit_action_interface tunkit_action_mark_correct_interface",o.innerHTML=`<img src="${(0,l._getURL)("icons/mark_correct_white.svg")}"> ${i.name}`,e.appendChild(o),t[n]={element:o,data:i}},addMarkIncorrectAction(n,i){const o=document.createElement("div");o.className="tunkit_action_interface tunkit_action_mark_incorrect_interface",o.innerHTML=`<img src="${(0,l._getURL)("icons/mark_incorrect_white.svg")}"> ${i.name}`,e.appendChild(o),t[n]={element:o,data:i}}}};const l=n(666),o=i(n(934))},741:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.getComponent)(".input_form_wrapper.action_wrapper",!1);return{addNewAction:()=>l(e),getElement:()=>e,onAddNewAction:t=>{e.querySelector("#tunkit_add_new_action").onclick=()=>{const n=l(e);t(n)}}}};const i=n(666);function l(e){const t=(0,i.getComponent)(".tunkit_btn_action_item",!1);return t.querySelector(".tunkit_btn_action_icon").src=(0,i._getURL)("icons/notification.svg"),e.querySelector(".tunkit_action_wrapper").appendChild(t),{getElement:()=>t,onClick:e=>{t.addEventListener("click",(()=>e()))},setIcon(e){t.querySelector(".tunkit_btn_action_icon").src=(0,i._getURL)(`icons/${e}.svg`)},setName(e){t.querySelector(".tunkit_btn_action_name").textContent=e}}}},135:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getDrawerPlayerComponent=function(){const e=document.createElement("div");e.className="tunkit_timeline_interface tunkit_action_handler";const t=(0,l.getPlayerOverlay)(1e3);t.render();const n=document.createElement("div");return n.className="tunkit_toggle_action_interface",n.innerHTML=`<img src="${(0,o._getURL)("icons/close_notification.svg")}">`,e.appendChild(n),function(e,t,n){let i=!1;const l=t.getBoundingClientRect();function o(){i=!1,this.style.cursor="default",e.style.zIndex="1000"}function a(){i=!0,this.style.cursor="col-resize",e.style.zIndex="998"}function r(t){i&&(e.style.width=100-t.offsetX/l.width*100+"%")}t.addEventListener("mouseup",o),t.addEventListener("mousedown",a),t.addEventListener("mousemove",r),t.addEventListener("mouseleave",(function(){i=!1,this.style.cursor="default",e.style.zIndex="1000"})),n.addEventListener("click",(function(){null==t||t.removeEventListener("mouseup",o),null==t||t.removeEventListener("mousedown",a),null==t||t.removeEventListener("mousemove",r),e.style.transitionDuration="0.4s"})),setTimeout((()=>{e.style.transitionDuration="initial"}),400)}(e,t.getElement(),n),n.addEventListener("click",(function(){a.default.VIDEO.play(),t.remove(),e.style.right="-100%",setTimeout((()=>{e.remove()}),500)})),{getElement:()=>e,getToggleButton:()=>n,getOverlay:()=>t,handle(){a.default.VIDEO.pause(),t.show(),a.default.VIDEO_PLAYER.appendChild(e),setTimeout((()=>{e.style.right="0"}),0)},setContent(t,i=!1){const l=document.createElement("span");l.className="tunkit_hint_player_drawer",l.innerText="*Holding outside to change the size",e[i?"innerHTML":"innerText"]=t,Object.assign(e.style,{display:"flex",flexDirection:"column",justifyContent:"space-between"}),e.appendChild(l),e.appendChild(n)}}};const l=n(827),o=n(666),a=i(n(934))},462:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){const e=(0,i.getComponent)(".tunkit_input_tags_wrapper",!1),t=e.querySelector("#tunkit_input_type_folder"),n=e.querySelector("#tunkit_list_folder");let o=[];return e.addEventListener("click",(()=>t.focus())),t.addEventListener("keyup",(function(e){let i=t.value;"Enter"===e.key&&i.length>0&&!o.includes(i)&&(o.push(i),l(n,o,i),t.value="")})),{getElement:()=>e,setData:function(e){!function(e,t){e.querySelectorAll("li:not(#tunkit_input_type_folder_li)").forEach((e=>e.remove())),t.forEach((n=>{l(e,t,n)}))}(n,e),o=e},getData:()=>o}};const i=n(666);function l(e,t,n){const l=document.createElement("li");l.innerText=n;const o=(0,i.getComponent)(".tunkit_close_icon_input_tags_wrapper",!1);l.prepend(o),e.appendChild(l),o.addEventListener("click",(function(){t.splice(t.indexOf(n),1),l.remove()}))}},948:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getInputTagsWithSelectComponent=function(){const e=(0,l.getComponent)(".tunkit_action_typing_item",!1),t=e.querySelector(".select_type_input_tag_with_select"),n=(0,o.default)();return n.getElement().querySelector("label").remove(),n.getElement().querySelector("#tunkit_select_folder_wrapper").style.marginTop="0",(0,l.insertAdjacentElement)(e,n.getElement(),".tunkit_action_typing_item_left"),{getElement:()=>e,INPUT_TAGS:n,getSelectElement:()=>t,setOptionSelect(e){const n=document.createElement("option");n.value=e[0],n.textContent=e[1],t.appendChild(n)},setType:e=>{if(null===t.querySelector('option[value="'+e+'"]'))throw new Error("Type not found");t.value=e},onClickSetting(t){e.querySelector(".tunkit_setting_action_typing").onclick=()=>t()}}};const l=n(666),o=i(n(462))},863:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBaseTimelineDialog=function(){const e=(0,o.getComponent)(".tunkit_timeline_note.base_timeline_dialog",!1),t=(0,l.default)();(0,o.insertAdjacentElement)(e,t.getElement(),".tunkit_base_info_wrapper");const n=e.querySelector(".tunkit_timeline_note_name"),i=e.querySelector(".tunkit_input_time.time_start"),r=e.querySelector(".tunkit_input_time.time_end");return{render(){a.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block",a.default.VIDEO.pause()},INPUT_TAG:t,getElement:()=>e,getName:()=>n.value,getStartTime:()=>(0,o.HmsToSeconds)(i.value),getEndTime:()=>(0,o.HmsToSeconds)(r.value),setTitle(t){e.querySelector("#tunkit_title_timeline").innerText=t},setName(e){n.value=e},setStartTime(e){i.value=(0,o.secondsToHms)(String(e))},setEndTime(e){r.value=(0,o.secondsToHms)(String(e))},onClickSave(t){e.querySelector(".tunkit_save_timeline_btn").onclick=()=>t()},onClickDelete(t){e.querySelector(".delete_timeline_button").onclick=()=>t()}}};const l=i(n(462)),o=n(666),a=i(n(934))},654:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFlashcardTimelineDialog=function(){const e=(0,a.getBaseTimelineDialog)(),t=(0,o.getComponent)(".panel_timeline_flashcard",!1),n=t.querySelector(".tunkit_timeline_flashcard_front_card"),i=t.querySelector(".tunkit_timeline_flashcard_back_card"),r=(0,l.default)();return(0,o.insertAdjacentElement)(e.getElement(),t,".tunkit_input_tags_wrapper"),(0,o.insertAdjacentElement)(e.getElement(),r.getElement(),".panel_timeline_flashcard"),{BASE:e,BUTTON_ADDER:r,render(){e.render()},getDataTimeline:()=>({front:n.value,back:i.value}),setDataTimeline(e){n.value=e.front,i.value=e.back}}};const l=i(n(741)),o=n(666),a=n(863)},73:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getMessageTimelineDialog=function(){const e=(0,a.getBaseTimelineDialog)(),t=(0,o.getComponent)(".panel_timeline_message",!1),n=t.querySelector(".tunkit_timeline_message"),i=(0,l.default)();return(0,o.insertAdjacentElement)(e.getElement(),t,".tunkit_input_tags_wrapper"),(0,o.insertAdjacentElement)(e.getElement(),i.getElement(),".panel_timeline_message"),{BASE:e,BUTTON_ADDER:i,render(){e.render()},getDataTimeline:()=>n.value,setDataTimeline(e){n.value=e}}};const l=i(n(741)),o=n(666),a=n(863)},123:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getPointerTimelineDialog=function(){const e=(0,a.getBaseTimelineDialog)(),t=(0,l.default)();return(0,o.insertAdjacentElement)(e.getElement(),t.getElement(),".tunkit_input_tags_wrapper"),{BASE:e,BUTTON_ADDER:t,render(){e.render()}}};const l=i(n(741)),o=n(666),a=n(863)},618:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getTemplateDialogComponent=function(){const e=(0,l.getComponent)(".tunkit_template",!1),t=e.querySelector(".tunkit_template_name"),n=e.querySelector(".tunkit_template_description");return{render(){o.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block",o.default.VIDEO.pause()},getName:()=>t.value,getDescription:()=>n.value,getElement:()=>e,setName(e){t.value=e},setDescription(e){n.value=e},onClickClose(t){e.querySelector(".tunkit_close_template").onclick=()=>t()},onClickSubmit(t){e.querySelector(".tunkit_save_template").onclick=()=>t()},onClickDelete(t){e.querySelector(".tunkit_delete_template").onclick=()=>t()}}};const l=n(666),o=i(n(934))},229:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getTypingTimelineDialog=function(){const e=(0,o.getBaseTimelineDialog)(),t=(0,l.getComponent)(".panel_timeline_typing",!1);(0,l.insertAdjacentElement)(e.getElement(),t,".tunkit_input_tags_wrapper");const n=t.querySelector(".tunkit_timeline_typing_card_question");return{BASE:e,render(){e.render()},getDataTimeline:()=>n.value,setDataTimeline(e){n.value=e},onAddNewAnswerItem(n){t.querySelector("#tunkit_add_new_action_typing").onclick=function(){const t=a(e);n(t)}},renderAnswerItem:()=>a(e)}},t.renderAnswerItem=a;const i=n(948),l=n(666),o=n(863);function a(e){const t=(0,i.getInputTagsWithSelectComponent)();return t.setOptionSelect(["equal","Equal"]),t.setOptionSelect(["otherwise","Otherwise"]),e.getElement().querySelector(".tunkit_action_typing_wrapper").appendChild(t.getElement()),{answerItem:t}}},328:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getUpdateActionDialog=function(){const e=(0,r.getComponent)(".tunkit_detail_timeline_note",!1),t=e.querySelector(".tunkit_action_name");return(0,a.handleShowPanel)(e,((e,t)=>t())),function(e){var t;null===(t=e.querySelector("#tunkit_select_action_type"))||void 0===t||t.addEventListener("change",(function(){var t;null===(t=e.querySelector(`#tunkit_action_${this.value}_hidden`))||void 0===t||t.click()}))}(e),(null!==u.default.TEMP_REFERENCE_ACTION_ELEMENT?new Promise((e=>{e(u.default.TEMP_REFERENCE_ACTION_ELEMENT.cloneNode(!0))})):o.default.getAll().then((e=>{const t=document.createDocumentFragment();return Object.keys(e).forEach((n=>{const i=(0,r.getComponent)(".tunkit_reference_note_item",!1);i.id=n,i.querySelector(".title").textContent=e[n].title;const o=Object.keys(e[n].template).length;i.querySelector(".total_template_reference_note").textContent=`${o} template${o>1?"s":""}`,i.querySelector(".thumbnail img").setAttribute("src",`https://img.youtube.com/vi/${n.substring(3)}/0.jpg`),Object.keys(e[n].template).forEach((t=>{const o=e[n].template[t],a=(0,r.getComponent)(".tunkit_reference_note_template_item",!1);a.id=t,a.querySelector(".item-info .title").textContent=o.name,a.querySelector(".item-info .views").textContent=o.description,Object.keys(o.timelineNotes).forEach((e=>{var t;const n=o.timelineNotes[e],u=Object.keys(o.timelineNotes).length;i.querySelector(".total_timeline_note_reference_note").textContent=`${u} timeline note${u>1?"s":""}`;const s=(0,r.getComponent)(".tunkit_reference_note_timeline_note_item",!1);s.querySelector(".child-title").textContent=n.name,s.querySelector(".type").textContent=l.default.GETNAME[n.type],s.querySelector(".timeline").textContent=(0,r.secondsToHms)(String(n.startTime)),s.setAttribute("for",e),s.querySelector('input[type="radio"]').id=e,null===(t=a.querySelector(".content"))||void 0===t||t.appendChild(s)})),i.appendChild(a)})),t.appendChild(i)})),u.default.TEMP_REFERENCE_ACTION_ELEMENT=t.cloneNode(!0),t}))).then((t=>{var n;null===(n=e.querySelector(".panel_action_reference_note"))||void 0===n||n.appendChild(t)})),{render(){u.default.DIALOG_WRAPPER.appendChild(e),e.style.display="block"},getActionName:()=>t.value,setActionName:e=>t.value=e,getElement:()=>e,getType:()=>e.querySelector("#tunkit_select_action_type").value,getData:function(){return s(this.getType(),e)},setData:(t,n)=>{setTimeout((()=>{var n;null===(n=e.querySelector(`#tunkit_action_${t}_hidden`))||void 0===n||n.click()}),0),e.querySelector("#tunkit_select_action_type").value=t,s(t,e,n)},onClickClose:function(t){e.querySelector(".tunkit_close_action_button").onclick=()=>t()},onClickUpdate:function(t){e.querySelector(".save_action_button").onclick=()=>t()},onClickDelete:function(t){e.querySelector(".delete_action_button").onclick=()=>t()}}};const l=i(n(103)),o=i(n(47)),a=n(221),r=n(666),u=i(n(934));function s(e,t,n=void 0){switch(e){case"notification":{const e=t.querySelector(".tunkit_action_notification_content");if("string"!=typeof n&&void 0!==n)throw new Error("Data must be string on Notification action");if(void 0===n)return e.value;e.value=n;break}case"jump_timeline":{const e=t.querySelector(".tunkit_action_jump_timeline_content"),i=t.querySelector(".tunkit_jump_timeline_message");if("object"!=typeof n&&void 0!==n)throw new Error("Data must be string on Jump timeline action");if(void 0===n)return{message:i.value,timeline:(0,r.HmsToSeconds)(e.value)};e.value=(0,r.secondsToHms)(String(n.timeline)),i.value=n.message;break}case"reference_note":if(void 0===n){const e=c(t);return{timeline_id:e.timeline_id.id,template_id:e.template_id.id,youtube_id:e.youtube_id.id}}{const e=setTimeout((()=>{if(null!==t.querySelector(".tunkit_reference_note_item")){const i=t.querySelector(`input[type="radio"].tunkit_checkbox#${n.timeline_id}`);if(i){i.checked=!0;const e=c(t);e.template_id.setAttribute("open","true"),e.youtube_id.setAttribute("open","true")}clearTimeout(e)}}),10)}break;case"mark_correct":case"mark_incorrect":if(void 0===n)return!0}}function c(e){var t,n;const i=e.querySelector('input[type="radio"][name="reference_note"].tunkit_checkbox:checked');if(null==i)throw new Error("Not found the selected timeline");const l=i.parentElement.parentElement.parentElement.parentElement;if(null==l||!(null===(t=null==l?void 0:l.classList)||void 0===t?void 0:t.contains("tunkit_reference_note_template_item")))throw new Error("Not found the selected template");const o=l.parentElement;if(null==o||!(null===(n=null==o?void 0:o.classList)||void 0===n?void 0:n.contains("tunkit_reference_note_item")))throw new Error("Not found the selected youtube");return{timeline_id:i,template_id:l,youtube_id:o}}},996:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonAdderWithDialogActionFlow=function(e,t){Object.keys(e).forEach((n=>{const i=t.BUTTON_ADDER.addNewAction();i.setName(e[n].name),i.setIcon(e[n].type),i.onClick((()=>a(e,n,i)))})),t.BUTTON_ADDER.onAddNewAction((function(t){const n=(0,l.randomString)();e[n]={name:"No title",type:"notification",data:"Enter you notification here"},t.onClick((()=>a(e,n,t)))}))};const i=n(328),l=n(666),o=n(195);function a(e,t,n){const l=(0,i.getUpdateActionDialog)();l.setActionName(e[t].name),l.setData(e[t].type,e[t].data);const a=(0,o.DialogWithOverlayFlow)(l.getElement(),{close_selector:[".tunkit_close_action_button"],overlay_z_index:2202});l.onClickUpdate((function(){e[t]={name:l.getActionName(),type:l.getType(),data:l.getData()},a.removeDialog(),a.removeOverlay(),n.setName(e[t].name),n.setIcon(e[t].type)})),l.onClickDelete((function(){confirm("Are you sure want to delete this action?")&&(delete e[t],n.getElement().remove(),a.removeDialog(),a.removeOverlay())})),l.render()}},122:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ButtonAdderWithPointerDialogActionFlow=function(e,t){Object.keys(e).forEach((n=>{const i=t.BUTTON_ADDER.addNewAction();i.setName(e[n].name),i.setIcon(e[n].type),i.onClick((()=>s(e,n,i)))})),t.BUTTON_ADDER.onAddNewAction((function(t){const n=(0,o.randomString)();e[n]={name:"No title",type:"notification",data:"Enter you notification here",axis:{x:50,y:50}},t.onClick((()=>s(e,n,t)))}))};const l=n(328),o=n(666),a=i(n(934)),r=n(420),u=n(195);function s(e,t,n){const i=(0,l.getUpdateActionDialog)(),s=(0,o.getComponent)("#set_pointer_btn",!1);s.onclick=function(){var n;a.default.DIALOG_WRAPPER.style.display="none",a.default.FULL_OVERLAY_WRAPPER.style.display="none",(0,r.initPointerVideo)(e,t),null===(n=a.default.PANEL_WRAPPER)||void 0===n||n.classList.remove("tunkit_menu_active")},(0,o.insertAdjacentElement)(i.getElement(),s,".tunkit_title_action"),i.setActionName(e[t].name),i.setData(e[t].type,e[t].data);const c=(0,u.DialogWithOverlayFlow)(i.getElement(),{close_selector:[".tunkit_close_action_button"],overlay_z_index:2202});i.onClickUpdate((function(){e[t].name=i.getActionName(),e[t].type=i.getType(),e[t].data=i.getData(),c.removeDialog(),c.removeOverlay(),n.setName(e[t].name),n.setIcon(e[t].type)})),i.onClickDelete((function(){confirm("Are you sure want to delete this action?")&&(delete e[t],n.getElement().remove(),c.removeDialog(),c.removeOverlay())})),i.render()}},195:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DialogWithOverlayFlow=function(e,t){var n;let l=null!=(null==t?void 0:t.overlay_z_index)?(0,i.getFullOverlay)(t.overlay_z_index):null;return null==l||l.render(),null===(n=t.close_selector)||void 0===n||n.map((t=>{e.querySelector(t).addEventListener("click",(function(){var t;e.remove(),null===(t=null==l?void 0:l.getElement())||void 0===t||t.remove()}))})),{removeOverlay:()=>{var e;return null===(e=null==l?void 0:l.getElement())||void 0===e?void 0:e.remove()},removeDialog:()=>e.remove()}};const i=n(827)},170:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ElementWithTimelineInterfaceHandlerAndCloseFlow=function(e,t,n,i){let s=function(){};switch(n.type){case"notification":s=function(){const e=new r.default(n.data);null!==i&&(i.hide(),i.setPreventShow(!0),e.getElement().getToggleButton().addEventListener("click",(function(){i.setPreventShow(!1)}))),e.handle()};break;case"jump_timeline":s=function(){const e=new l.default(n.data);null!==i&&(i.hide(),i.setPreventShow(!0),e.getDrawerElement().getToggleButton().addEventListener("click",(function(){i.setPreventShow(!1)}))),e.handle()};break;case"reference_note":s=function(){const e=new u.default(n.data);null!==i&&(i.hide(),i.setPreventShow(!0),e.getElement().getToggleButton().addEventListener("click",(function(){i.setPreventShow(!1)}))),e.handle()};break;case"mark_correct":s=function(){const e=new o.default(n);null!==i&&(i.hide(),i.setPreventShow(!0)),e.handle(),setTimeout((()=>{null!==i&&i.setPreventShow(!1),d(t),e.removeElement()}),2e3)};break;case"mark_incorrect":s=function(){const e=new a.default(n);null!==i&&(i.hide(),i.setPreventShow(!0)),setTimeout((()=>{null!==i&&i.setPreventShow(!1),d(t),e.removeElement()}),2e3),e.handle()}}null!==e?e.addEventListener("click",(()=>s())):s()};const l=i(n(132)),o=i(n(900)),a=i(n(441)),r=i(n(804)),u=i(n(208)),s=n(145),c=i(n(934));function d(e){Object.values(c.default.TEMP_SCORE_DATA.timeline).forEach((t=>{1!=t.is_executed&&t.data.map((n=>{n.action_id==e&&(c.default.TEMP_SCORE_DATA["mark_correct"==n.type?"current_correct":"current_incorrect"]++,(0,s.setSegmentScore)(),t.is_executed=!0)}))}))}},28:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InputTagSelectWithDialogFlow=function(e,t){Object.keys(e).forEach((n=>{const i=t.renderAnswerItem();i.answerItem.INPUT_TAGS.setData(e[n].include),r(n,e,i),i.answerItem.setType(e[n].select_type),i.answerItem.onClickSetting((()=>a(e,n,i))),"otherwise"==i.answerItem.getSelectElement().value&&(i.answerItem.INPUT_TAGS.getElement().style.display="none")})),t.onAddNewAnswerItem((function(t){const n=(0,l.randomString)();e[n]={name:"No title",type:"notification",data:"Enter you notification here",select_type:"equal",include:t.answerItem.INPUT_TAGS.getData()},r(n,e,t),t.answerItem.onClickSetting((()=>a(e,n,t)))}))};const i=n(328),l=n(666),o=n(195);function a(e,t,n){const l=(0,i.getUpdateActionDialog)();l.setActionName(e[t].name),l.setData(e[t].type,e[t].data);const a=(0,o.DialogWithOverlayFlow)(l.getElement(),{close_selector:[".tunkit_close_action_button"],overlay_z_index:2202});l.onClickUpdate((function(){e[t].name=l.getActionName(),e[t].type=l.getType(),e[t].data=l.getData(),a.removeDialog(),a.removeOverlay()})),l.onClickDelete((function(){confirm("Are you sure want to delete this typing answer?")&&(delete e[t],n.answerItem.getElement().remove(),a.removeDialog(),a.removeOverlay())})),l.render()}function r(e,t,n){const i=n.answerItem.getSelectElement();i.addEventListener("change",(function(){n.answerItem.INPUT_TAGS.getElement().style.display="otherwise"==i.value?"none":"block"})),n.answerItem.getSelectElement().addEventListener("change",(function(){if("otherwise"==i.value){let l=!0;for(let e in t)if("otherwise"==t[e].select_type){alert('Just one "otherwise" is allowed'),l=!1,i.value="equal",n.answerItem.INPUT_TAGS.getElement().style.display="block";break}l&&(t[e].select_type=i.value)}else t[e].select_type=i.value}))}},879:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(l,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function r(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(433),a=l(n(500)),r=n(221),u=n(262);new MutationObserver(((e,t)=>i(void 0,void 0,void 0,(function*(){"complete"===document.readyState&&!document.querySelector("#tunkit_interactive_button")&&document.querySelector(".ytp-subtitles-button.ytp-button")&&((0,o.insertToggleIconMenu)(),yield(0,o.insertComponent)(),(0,o.insertMenuPanel)(),(0,r.handleToggleMenuSwitcherIcon)(),(0,o.handelTogglePanel)(),(0,r.handleChangeViewPanel)(),(0,u.handleCreateTemplatePanel)(),(0,a.default)(),t.disconnect())})))).observe(document,{childList:!0,subtree:!0})},433:function(e,t,n){var i,l=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n);var l=Object.getOwnPropertyDescriptor(t,n);l&&!("get"in l?!t.__esModule:l.writable||l.configurable)||(l={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,i,l)}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||(i=function(e){return i=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[t.length]=n);return t},i(e)},function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n=i(e),a=0;a<n.length;a++)"default"!==n[a]&&l(t,e,n[a]);return o(t,e),t}),r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(l,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function r(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.component_wrapper=void 0,t.insertToggleIconMenu=function(){const e=document.querySelector(".ytp-subtitles-button.ytp-button");if(null==e)throw new Error("Can't insert trigger button");const t=document.createElement("button");t.classList.add("ytp-button"),t.id="tunkit_interactive_button",t.innerHTML=`<img id="tunkit_svg" aria-pressed="false" class="ytp-svg-shadow" src="${(0,u._getURL)("icons/panel_icon.svg")}"/>`,e.insertAdjacentElement("afterend",t)},t.insertComponent=function(){return r(this,void 0,void 0,(function*(){yield fetch((0,u._getURL)("static/bundle.html")).then((e=>e.text())).then((function(e){const n=(0,u._getURL)("icons/");e=e.replaceAll(/{{icon\./g,n).replaceAll("}}",".svg"),t.component_wrapper.innerHTML=e,(0,s.initAfterInsertComponent)()}))}))},t.insertMenuPanel=function(){var e;null===(e=document.querySelector(".ytp-popup.ytp-settings-menu"))||void 0===e||e.insertAdjacentElement("afterend",s.default.PANEL_WRAPPER)},t.handelTogglePanel=function(){const e=document.querySelector("#tunkit_interactive_button");if(null==e)throw new Error("Can't find trigger button");e.addEventListener("click",(()=>s.default.PANEL_WRAPPER.classList.toggle("tunkit_menu_active")))};const u=n(666),s=a(n(934));t.component_wrapper=document.createElement("div")},733:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(174),o=n(170),a=n(827),r=n(666),u=i(n(934)),s=i(n(349));class c extends s.default{constructor(e){super(e),this.element=(0,r.getComponent)(".tunkit_timeline_interface.tunkit_timeline_flashcard_interface",!1),this.element.querySelector(".tunkit_flashcard_front").textContent=this.data.data.front,this.element.querySelector(".tunkit_flashcard_back").textContent=this.data.data.back,this.overlay=(0,a.getPlayerOverlay)(),this.action=(0,l.getActionButtons)(),this.action.setActionData(this.data.action);const t=this.action.getActionData();Object.keys(t).forEach((e=>{(0,o.ElementWithTimelineInterfaceHandlerAndCloseFlow)(t[e].element,e,t[e].data,this)}))}getElement(){return this.element}removeElement(){this.element.remove()}render(){u.default.VIDEO_PLAYER.appendChild(this.element),this.overlay.getElement().style.height="0",this.overlay.render(),this.action.render()}show(){var e;this.is_prevent_show||(null===(e=u.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),this.overlay.getElement().style.height="100%",this.element.style.left="0",this.showAction(),this.is_showing=!0)}showAction(){this.action.show()}hideAction(){this.action.hide()}hide(){this.overlay.getElement().style.height="0",this.element.style.left="-100%",this.hideAction(),this.is_showing=!1}}t.default=c},4:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(174),o=n(170),a=n(827),r=i(n(934)),u=i(n(349));class s extends u.default{constructor(e){super(e),this.element=document.createElement("div"),this.element.className="tunkit_timeline_interface",this.element.innerText=this.data.data,this.overlay=(0,a.getPlayerOverlay)(),this.action=(0,l.getActionButtons)(),this.action.setActionData(this.data.action);const t=this.action.getActionData();Object.keys(t).forEach((e=>{(0,o.ElementWithTimelineInterfaceHandlerAndCloseFlow)(t[e].element,e,t[e].data,this)}))}getElement(){return this.element}removeElement(){this.element.remove()}render(){r.default.VIDEO_PLAYER.appendChild(this.element),this.overlay.getElement().style.height="0",this.overlay.render(),this.action.render()}show(){var e;this.is_prevent_show||(null===(e=r.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),this.overlay.getElement().style.height="100%",this.element.style.left="0",this.showAction(),this.is_showing=!0)}showAction(){this.action.show()}hideAction(){this.action.hide()}hide(){this.overlay.getElement().style.height="0",this.element.style.left="-100%",this.hideAction(),this.is_showing=!1}}t.default=s},124:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(170),o=n(827),a=i(n(934)),r=i(n(349));class u extends r.default{constructor(e){super(e),this.element=document.createElement("div"),this.element.className="tunkit_timeline_interface tunkit_timeline_pointer_interface",this.overlay=(0,o.getPlayerOverlay)(),Object.entries(this.data.action).forEach((([e,t])=>{const n=document.createElement("button");Object.assign(n.style,{left:`${t.axis.x}%`,top:`${t.axis.y}%`}),n.className="tunkit_gradient_button_copy_by_css_scan",n.setAttribute("role","button"),(0,l.ElementWithTimelineInterfaceHandlerAndCloseFlow)(n,e,t,this),n.innerText=t.name,this.element.appendChild(n)}))}getElement(){return this.element}removeElement(){this.element.remove()}render(){a.default.VIDEO_PLAYER.appendChild(this.element),this.overlay.getElement().style.height="0",this.overlay.render()}show(){var e;this.is_prevent_show||(null===(e=a.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),this.overlay.getElement().style.height="100%",this.element.style.transform="scale(1)",this.is_showing=!0)}hide(){this.overlay.getElement().style.height="0",this.element.style.transform="scale(0)",this.is_showing=!1}}t.default=u},349:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(e){this.is_prevent_show=!1,this.is_showing=!1,this.data=e}isShow(){return this.is_showing}isPreventShow(){return this.is_prevent_show}setPreventShow(e){this.is_prevent_show=e}}},560:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(170),o=n(827),a=n(666),r=i(n(934)),u=i(n(349));class s extends u.default{constructor(e){super(e),this.element=(0,a.getComponent)(".tunkit_action_typing_interface",!1),this.handleClickCancel(),this.handleEventOnInput(),this.handleClickSubmit(),this.overlay=(0,o.getPlayerOverlay)()}handleClickSubmit(){var e;const t=this;null===(e=this.element.querySelector(".tunkit_button_typing_submit"))||void 0===e||e.addEventListener("click",(function(){const e=t.element.querySelector(".tunkit_input_timeline_typing").value;let n=!1,i="";if(Object.entries(t.data.action).forEach((([o,a])=>{"otherwise"===a.select_type?i=o:a.include.includes(e)&&(n=!0,t.hide(),(0,l.ElementWithTimelineInterfaceHandlerAndCloseFlow)(null,o,a,null))})),!n){if(""==i)throw new Error("Not found otherwise key");(0,l.ElementWithTimelineInterfaceHandlerAndCloseFlow)(null,i,t.data.action[i],null)}(0,a.isForcePauseVideo)(!1),t.setPreventShow(!0),t.element.querySelector(".tunkit_input_timeline_typing").value="",t.hide(),r.default.VIDEO.play()}))}handleEventOnInput(){var e;const t=this;null===(e=this.element.querySelector(".tunkit_input_timeline_typing"))||void 0===e||e.addEventListener("keydown",(function(e){e.stopPropagation(),(0,a.isForcePauseVideo)(!0,t.data.startTime)}))}handleClickCancel(){var e;const t=this;null===(e=this.element.querySelector(".tunkit_button_typing_cancel"))||void 0===e||e.addEventListener("click",(function(){t.setPreventShow(!0),(0,a.isForcePauseVideo)(!1),t.element.querySelector(".tunkit_input_timeline_typing").blur(),t.element.querySelector(".tunkit_input_timeline_typing").value="",t.hide(),r.default.VIDEO.play()}))}getElement(){return this.element}removeElement(){this.element.remove()}render(){r.default.VIDEO_PLAYER.appendChild(this.element),this.overlay.getElement().style.height="0",this.overlay.render()}show(){var e;this.is_prevent_show||(null===(e=r.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),this.overlay.getElement().style.height="100%",this.element.style.left="0",this.is_showing=!0,this.element.querySelector(".tunkit_input_timeline_typing").focus())}hide(){(r.default.VIDEO.currentTime<this.data.startTime||r.default.VIDEO.currentTime>this.data.endTime)&&(this.setPreventShow(!1),(0,a.isForcePauseVideo)(!1),this.element.querySelector(".tunkit_input_timeline_typing").value=""),this.overlay.getElement().style.height="0",this.element.style.left="-100%",this.is_showing=!1}}t.default=s},132:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(135),o=i(n(934));t.default=class{constructor(e){var t;this.getDrawerElement=()=>this.element,this.data=e,this.element=(0,l.getDrawerPlayerComponent)(),this.element.getElement().classList.add("tunkit_action_jump_timeline_handler"),null===(t=this.element.getElement().querySelector(".tunkit_toggle_action_interface img"))||void 0===t||(t.style.filter="hue-rotate(210deg)"),this.element.setContent(this.data.message)}handle(){o.default.VIDEO.currentTime=this.data.timeline,o.default.VIDEO.play(),this.element.handle()}}},900:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=i(n(934));t.default=class{constructor(e){this.element=document.createElement("div"),this.action_data=e}handle(){this.element.className="tunkit_player_correct_and_incorrect tunkit_flex_center tunkit_player_overlay_correct",this.element.innerText="Correct",l.default.VIDEO_PLAYER.appendChild(this.element)}removeElement(){this.element.remove()}}},441:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=i(n(934));t.default=class{constructor(e){this.element=document.createElement("div"),this.action_data=e}handle(){this.element.className="tunkit_player_correct_and_incorrect tunkit_flex_center tunkit_player_overlay_incorrect",this.element.innerText="Incorrect",l.default.VIDEO_PLAYER.appendChild(this.element)}removeElement(){this.element.remove()}}},804:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const i=n(135);t.default=class{constructor(e){const t=(0,i.getDrawerPlayerComponent)();this.element=t,t.setContent(e),t.getElement().classList.add("tunkit_action_notification_handler")}getElement(){return this.element}handle(){this.element.handle()}}},208:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(135),o=i(n(834));t.default=class{constructor(e){var t;this.data=e;const n=(0,l.getDrawerPlayerComponent)();this.element=n,this.element.getElement().classList.add("tunkit_action_reference_handler"),null===(t=this.element.getElement().querySelector(".tunkit_toggle_action_interface img"))||void 0===t||(t.style.filter="hue-rotate(210deg)")}getElement(){return this.element}handle(){const e=this.data.youtube_id.substring(3);o.default.from(e).get(this.data.template_id).then((t=>{var n;const i=null===(n=null==t?void 0:t.timelineNotes)||void 0===n?void 0:n[this.data.timeline_id];if(!i)throw new Error("Timeline not found");const l=document.createElement("iframe");l.width="100%",l.src=`https://www.youtube.com/embed/${e}?start=${i.startTime}&end=${i.endTime}`,l.frameBorder="0",l.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; web-share",l.referrerPolicy="strict-origin-when-cross-origin",l.style.height="70%",this.element.setContent(l.outerHTML,!0),this.element.handle()}))}}},834:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(666),o=i(n(934));t.default=class{static from(e){return{getAll(){const t=(0,l.getTitleYoutube)();return chrome.runtime.sendMessage({type:"GET_ALL_TEMPLATE",youtubeID:e,title:t})},get:t=>chrome.runtime.sendMessage({type:"GET_TEMPLATE",youtubeID:e,id:t}),insert(t){o.default.TEMP_REFERENCE_ACTION_ELEMENT=null;const n=(0,l.randomString)();return chrome.runtime.sendMessage({type:"INSERT_TEMPLATE",youtubeID:e,id:n,data:t}).then((()=>({status:"success",id:n})))},remove:t=>(o.default.TEMP_REFERENCE_ACTION_ELEMENT=null,chrome.runtime.sendMessage({type:"REMOVE_TEMPLATE",youtubeID:e,id:t})),update:(t,n)=>(o.default.TEMP_REFERENCE_ACTION_ELEMENT=null,chrome.runtime.sendMessage({type:"UPDATE_TEMPLATE",youtubeID:e,id:t,data:n}))}}}},103:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const l=n(666),o=i(n(934)),a=i(n(834));class r{static from(e){return{withTemplate:t=>({insert(n){o.default.TEMP_REFERENCE_ACTION_ELEMENT=null;const i=(0,l.randomString)();return a.default.from(e).get(t).then((l=>{l.timelineNotes[i]=n;const o=Date.now();return l.timelineNotes[i].created_at=o,l.timelineNotes[i].updated_at=o,a.default.from(e).update(t,{timelineNotes:l.timelineNotes}).then((function(e){return{status:e.status,id:i}}))}))},update:(n,i)=>(o.default.TEMP_REFERENCE_ACTION_ELEMENT=null,a.default.from(e).get(t).then((l=>{var o;if(null==(null===(o=null==l?void 0:l.timelineNotes)||void 0===o?void 0:o[n]))throw new Error("Timeline not found");return l.timelineNotes[n]=i,l.timelineNotes[n].updated_at=Date.now(),a.default.from(e).update(t,{timelineNotes:l.timelineNotes}).then((function(e){return{status:e.status}}))}))),remove:n=>(o.default.TEMP_REFERENCE_ACTION_ELEMENT=null,a.default.from(e).get(t).then((i=>{var l;if(null==(null===(l=null==i?void 0:i.timelineNotes)||void 0===l?void 0:l[n]))throw new Error("Timeline not found");return delete i.timelineNotes[n],a.default.from(e).update(t,{timelineNotes:i.timelineNotes}).then((function(e){return{status:e.status}}))})))})}}}r.GETNAME={message:"Message",flashcard:"Flashcard",typing:"Typing",pointer:"Pointer"},t.default=r},47:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{static getAll(){return chrome.runtime.sendMessage({type:"GET_ALL_DATA"})}static from(e){return{getTitle:()=>chrome.runtime.sendMessage({type:"GET_TITLE_YOUTUBE",youtubeID:e}),setTitle:t=>chrome.runtime.sendMessage({type:"SET_TITLE_YOUTUBE",youtubeID:e,title:t})}}}},500:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){navigation.addEventListener("navigate",(()=>{var e;null===(e=o.default.PANEL_WRAPPER)||void 0===e||e.classList.remove("tunkit_menu_active"),(0,l.showPanel)(".tunkit_panel.panel_main","tunkit_panel_active"),o.default.IS_GET_TEMPLATE=!1,(0,l.setDisableItems)(o.default.PANEL_WRAPPER,".tunkit_disable_for_template",!0),(0,l.setCurrentTemplate)("Off"),(0,l.setCurrentTotalNotes)("Off"),o.default.IS_GET_TIMELINE=!1,o.default.CURRENT_TEMPLATE_ID=null,o.default.TIMELINE_NOTE={},o.default.FULL_OVERLAY_WRAPPER.innerHTML="",o.default.DIALOG_WRAPPER.innerHTML="",r(),(0,a.activeTimelineInVideo)({playing:"remove",timeout:"clear",video:"remove"})}))},t.removeAllInteractionElements=r;const l=n(221),o=i(n(934)),a=n(420);function r(){var e,t,n,i,l,a,r,u,s;null===(e=o.default.VIDEO_PLAYER)||void 0===e||e.querySelectorAll(".tunkit_timeline_interface").forEach((e=>e.remove())),null===(t=o.default.VIDEO_PLAYER)||void 0===t||t.querySelectorAll(".tunkit_timeline_action_wrapper").forEach((e=>e.remove())),null===(n=o.default.VIDEO_PLAYER)||void 0===n||n.querySelectorAll(".tunkit_action_handler").forEach((e=>e.remove())),null===(i=o.default.VIDEO_PLAYER)||void 0===i||i.querySelectorAll(".tunkit_player_correct_and_incorrect").forEach((e=>e.remove())),null===(l=o.default.VIDEO_PLAYER)||void 0===l||l.querySelectorAll(".tunkit_player_overlay").forEach((e=>e.remove())),null===(a=o.default.VIDEO_PLAYER)||void 0===a||a.querySelectorAll(".tunkit_pointer_wrapper").forEach((e=>e.remove())),null===(r=o.default.VIDEO_PLAYER)||void 0===r||r.querySelectorAll(".tunkit_pointer_overlay").forEach((e=>e.remove())),null===(u=o.default.VIDEO_PLAYER)||void 0===u||u.querySelectorAll(".tunkit_pointer_buttons").forEach((e=>e.remove())),null===(s=o.default.VIDEO_PLAYER)||void 0===s||s.querySelectorAll(".tunkit_pointer_child").forEach((e=>e.remove()))}},459:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){switch(e){case"message":return new o.default(t);case"flashcard":return new l.default(t);case"typing":return new r.default(t);case"pointer":return new a.default(t)}};const l=i(n(733)),o=i(n(4)),a=i(n(124)),r=i(n(560))},790:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DialogTimelineTypeNavigator=function(e){switch(e){case"message":return(0,l.getMessageTimelineDialog)();case"flashcard":return(0,i.getFlashcardTimelineDialog)();case"typing":return(0,a.getTypingTimelineDialog)();case"pointer":return(0,o.getPointerTimelineDialog)()}};const i=n(654),l=n(73),o=n(123),a=n(229)},827:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getFullOverlay=function(e){const t=l.default.FULL_OVERLAY.cloneNode(!0);return e&&(t.style.zIndex=String(e)),{render(){l.default.FULL_OVERLAY_WRAPPER.appendChild(t)},getElement:()=>t}},t.getPlayerOverlay=function(e){const t=o.cloneNode(!0);return e&&(t.style.zIndex=String(e)),{getElement:()=>t,render(){t.style.height="0",l.default.VIDEO_PLAYER.appendChild(t)},show(){t.style.height="100%"},hide(){t.style.height="0"},remove:()=>{t.style.height="0",setTimeout((()=>{t.remove()}),1e3)}}};const l=i(n(934)),o=document.createElement("div");o.className="tunkit_player_overlay"},221:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleShowPanel=v,t.handleChangeViewPanel=function(){v(f.default.PANEL_WRAPPER,(function(e,t){if(0!=A())switch(e.dataset.tunkitPanel){case"main":t();break;case"template":if(t(),f.default.IS_GET_TEMPLATE)break;(0,T.handleLoadTemplate)(),f.default.IS_GET_TEMPLATE=!0;break;case"note":if(!f.default.CURRENT_TEMPLATE_ID)break;if(t(),f.default.IS_GET_TIMELINE)break;(0,h.handleLoadTimeline)(),f.default.IS_GET_TIMELINE=!0;break;case"track":if(null==f.default.CURRENT_TEMPLATE_ID)break;t();break;case"create_message_timeline":if(!f.default.CURRENT_TEMPLATE_ID)return;!function(){var e;const t=(0,o.getMessageTimelineDialog)(),n=(0,c.DialogWithOverlayFlow)(t.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201});t.BASE.setTitle("Create message timeline"),t.BASE.setStartTime(f.default.VIDEO.currentTime),t.BASE.setEndTime(f.default.VIDEO.currentTime+5),null===(e=t.BASE.getElement().querySelector(".delete_timeline_button"))||void 0===e||e.remove();const i={};(0,u.ButtonAdderWithDialogActionFlow)(i,t),t.render(),t.BASE.onClickSave((function(){const e={name:t.BASE.getName(),startTime:t.BASE.getStartTime(),endTime:t.BASE.getEndTime(),tags:t.BASE.INPUT_TAG.getData(),data:t.getDataTimeline(),action:i,type:"message",timeline:(0,E.getTimelineTextFormat)(t.BASE.getStartTime(),t.BASE.getEndTime())};_.default.from((0,E.getCurrentYoutubeId)()).withTemplate(f.default.CURRENT_TEMPLATE_ID).insert(e).then((t=>{if("success"==t.status){f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes[t.id]=e;const i=(0,h.getTimelinePanelItem)();i.setTimelineText(e.startTime,e.endTime),i.setName(e.name),i.setType(e.type),i.onClick((()=>(0,h.handleClickTimelineItemPanel)(t.id,i))),i.render(),n.removeDialog(),n.removeOverlay(),f.default.IS_GET_TEMPLATE=!1,P(Object.keys(f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes).length),(0,m.removeAllInteractionElements)(),(0,p.activeTimelineInVideo)(N())}}))}))}();break;case"create_flashcard_timeline":if(!f.default.CURRENT_TEMPLATE_ID)return;!function(){var e;const t=(0,l.getFlashcardTimelineDialog)(),n=(0,c.DialogWithOverlayFlow)(t.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201});t.BASE.setTitle("Create flashcard timeline"),t.BASE.setStartTime(f.default.VIDEO.currentTime),t.BASE.setEndTime(f.default.VIDEO.currentTime+5),null===(e=t.BASE.getElement().querySelector(".delete_timeline_button"))||void 0===e||e.remove();const i={};(0,u.ButtonAdderWithDialogActionFlow)(i,t),t.render(),t.BASE.onClickSave((function(){const e={name:t.BASE.getName(),startTime:t.BASE.getStartTime(),endTime:t.BASE.getEndTime(),tags:t.BASE.INPUT_TAG.getData(),data:t.getDataTimeline(),action:i,type:"flashcard",timeline:(0,E.getTimelineTextFormat)(t.BASE.getStartTime(),t.BASE.getEndTime())};_.default.from((0,E.getCurrentYoutubeId)()).withTemplate(f.default.CURRENT_TEMPLATE_ID).insert(e).then((t=>{if("success"==t.status){f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes[t.id]=e;const i=(0,h.getTimelinePanelItem)();i.setTimelineText(e.startTime,e.endTime),i.setName(e.name),i.setType(e.type),i.onClick((()=>(0,h.handleClickTimelineItemPanel)(t.id,i))),i.render(),n.removeDialog(),n.removeOverlay(),f.default.IS_GET_TEMPLATE=!1,P(Object.keys(f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes).length),(0,m.removeAllInteractionElements)(),(0,p.activeTimelineInVideo)(N())}}))}))}();break;case"create_typing_timeline":if(!f.default.CURRENT_TEMPLATE_ID)return;!function(){var e;const t=(0,r.getTypingTimelineDialog)();t.BASE.setTitle("Create typing timeline"),t.BASE.setStartTime(f.default.VIDEO.currentTime),t.BASE.setEndTime(f.default.VIDEO.currentTime+5),null===(e=t.BASE.getElement().querySelector(".delete_timeline_button"))||void 0===e||e.remove();const n=(0,c.DialogWithOverlayFlow)(t.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201}),i={};(0,d.InputTagSelectWithDialogFlow)(i,t),t.render(),t.BASE.onClickSave((function(){const e=Object.keys(i).find((e=>"otherwise"==i[e].select_type));if(!e)return void alert('It must have one "otherwise" action.');i[e].include=[];const l={name:t.BASE.getName(),startTime:t.BASE.getStartTime(),endTime:t.BASE.getEndTime(),tags:t.BASE.INPUT_TAG.getData(),data:{question:t.getDataTimeline()},action:i,type:"typing",timeline:(0,E.getTimelineTextFormat)(t.BASE.getStartTime(),t.BASE.getEndTime())};_.default.from((0,E.getCurrentYoutubeId)()).withTemplate(f.default.CURRENT_TEMPLATE_ID).insert(l).then((e=>{if("success"==e.status){f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes[e.id]=l;const t=(0,h.getTimelinePanelItem)();t.setTimelineText(l.startTime,l.endTime),t.setName(l.name),t.setType(l.type),t.onClick((()=>(0,h.handleClickTimelineItemPanel)(e.id,t))),t.render(),n.removeDialog(),n.removeOverlay(),f.default.IS_GET_TEMPLATE=!1,P(Object.keys(f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes).length),(0,m.removeAllInteractionElements)(),(0,p.activeTimelineInVideo)(N())}}))}))}();break;case"create_pointer_timeline":if(!f.default.CURRENT_TEMPLATE_ID)return;!function(){var e;const t=(0,a.getPointerTimelineDialog)();t.BASE.setStartTime(f.default.VIDEO.currentTime),t.BASE.setEndTime(f.default.VIDEO.currentTime+5),t.BASE.setTitle("Create pointer timeline"),null===(e=t.BASE.getElement().querySelector(".delete_timeline_button"))||void 0===e||e.remove();const n=(0,c.DialogWithOverlayFlow)(t.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201}),i={};(0,s.ButtonAdderWithPointerDialogActionFlow)(i,t),t.render(),t.BASE.onClickSave((function(){const e={name:t.BASE.getName(),startTime:t.BASE.getStartTime(),endTime:t.BASE.getEndTime(),tags:t.BASE.INPUT_TAG.getData(),data:{},action:i,type:"pointer",timeline:(0,E.getTimelineTextFormat)(t.BASE.getStartTime(),t.BASE.getEndTime())};_.default.from((0,E.getCurrentYoutubeId)()).withTemplate(f.default.CURRENT_TEMPLATE_ID).insert(e).then((t=>{if("success"==t.status){f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes[t.id]=e;const i=(0,h.getTimelinePanelItem)();i.setTimelineText(e.startTime,e.endTime),i.setName(e.name),i.setType(e.type),i.onClick((()=>(0,h.handleClickTimelineItemPanel)(t.id,i))),i.render(),n.removeDialog(),n.removeOverlay(),f.default.IS_GET_TEMPLATE=!1,P(Object.keys(f.default.TIMELINE_NOTE[f.default.CURRENT_TEMPLATE_ID].timelineNotes).length),(0,m.removeAllInteractionElements)(),(0,p.activeTimelineInVideo)(N())}}))}))}()}}))},t.showPanel=g,t.handleToggleMenuSwitcherIcon=function(){var e,t;null===(t=null===(e=f.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_toggle_interactive_video"))||void 0===t||t.addEventListener("click",(function(){y(!A()),(0,p.activeTimelineInVideo)(N())}))},t.setActivePanel=y,t.getActivePanel=A,t.setDisableItems=function(e,t,n){e.querySelectorAll(t).forEach((e=>{e.style.opacity=n?"0.5":"1"}))},t.setCurrentTemplate=function(e){var t;null===(t=f.default.PANEL_WRAPPER)||void 0===t||(t.querySelector(".tunkit_current_template").textContent=e)},t.setCurrentTotalNotes=P,t.getStateActiveTimelineInVideo=N;const l=n(654),o=n(73),a=n(123),r=n(229),u=n(996),s=n(122),c=n(195),d=n(28),_=i(n(103)),m=n(500),E=n(666),f=i(n(934)),p=n(420),T=n(262),h=n(851);function v(e,t=void 0){e.querySelectorAll("*[data-tunkit-panel]").forEach((e=>{e.addEventListener("click",(function(){void 0!==t&&t(e,(function(){g(".tunkit_panel.panel_"+e.dataset.tunkitPanel,e.dataset.tunkitType)}))}))}))}function g(e,t,n=document){var i,l,o,a;null===(l=null===(i=n.querySelector("."+t))||void 0===i?void 0:i.classList)||void 0===l||l.remove(t),null===(a=null===(o=n.querySelector(e))||void 0===o?void 0:o.classList)||void 0===a||a.add(t)}function y(e){var t,n;(null===(t=f.default.PANEL_WRAPPER)||void 0===t?void 0:t.querySelector("#tunkit_toggle_interactive_video")).setAttribute("aria-checked",e?"true":"false"),Object.assign(null===(n=f.default.PANEL_WRAPPER)||void 0===n?void 0:n.querySelector(".tunkit_content").style,{opacity:e?"1":"0.5",pointerEvents:e?"auto":"none"})}function A(){var e;return"true"==(null===(e=f.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_toggle_interactive_video")).getAttribute("aria-checked")}function P(e){var t;null===(t=f.default.PANEL_WRAPPER)||void 0===t||(t.querySelector(".tunkit_total_notes").innerText="number"==typeof e?`${e} note${e>1?"s":""}`:e)}function N(){const e=A(),t={};return"string"==typeof f.default.CURRENT_TEMPLATE_ID&&(t.data_timeline="set"),t.playing=e&&"string"==typeof f.default.CURRENT_TEMPLATE_ID?"add":"remove",t.video=e&&"string"==typeof f.default.CURRENT_TEMPLATE_ID?"add":"remove",t.timeout="clear",t}},262:function(e,t,n){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(l,o){function a(e){try{u(i.next(e))}catch(e){o(e)}}function r(e){try{u(i.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,r)}u((i=i.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleLoadTemplate=function(){return i(this,void 0,void 0,(function*(){var e;const t=null===(e=c.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_loader.loader_template");t.style.display="block",c.default.TEMPLATE_PANEL_WRAPPER.innerHTML="";const n=yield r.default.from((0,s.getCurrentYoutubeId)()).getAll();c.default.TIMELINE_NOTE=n,Object.keys(n).forEach((e=>{const t=E();t.setName(c.default.TIMELINE_NOTE[e].name),t.setTotalNotes(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),f(e,t),t.render()})),t.style.display="none"}))},t.getTemplateItemComponent=E,t.handleCreateTemplatePanel=function(){c.default.PANEL_WRAPPER.querySelector(".create_new_template_btn").onclick=function(){var e;const t=(0,o.getTemplateDialogComponent)(),n=(0,a.DialogWithOverlayFlow)(t.getElement(),{close_selector:[".tunkit_close_template"],overlay_z_index:2201});null===(e=t.getElement().querySelector(".tunkit_title_template_dialog"))||void 0===e||(e.innerText="Create Template"),t.getElement().querySelector(".tunkit_delete_template").remove(),t.render(),t.onClickSubmit((function(){const e={name:t.getName(),description:t.getDescription(),timelineNotes:{}};r.default.from((0,s.getCurrentYoutubeId)()).insert(e).then((t=>{if("success"==t.status&&t.id){c.default.TIMELINE_NOTE[t.id]=e;const i=E();i.setName(e.name),i.setTotalNotes(0),f(t.id,i),i.getElement().querySelector(".ytp-menuitem-label").innerHTML+=' <sup class="tunkit_new_template">new</sup>',i.getElement().addEventListener("click",(function(){i.setName(e.name)}),{once:!0}),c.default.TEMPLATE_PANEL_WRAPPER.prepend(i.getElement()),n.removeDialog(),n.removeOverlay()}}))}))}};const o=n(618),a=n(195),r=l(n(834)),u=n(500),s=n(666),c=l(n(934)),d=n(420),_=n(221),m=n(145);function E(){const e=(0,s.getComponent)(".tunkit_template_panel_item",!1),t=e.querySelector(".tunkit_template_panel_item_name"),n=e.querySelector(".tunkit_template_panel_item_total_note");return{render(){c.default.TEMPLATE_PANEL_WRAPPER.appendChild(e)},setName(e){t.textContent=e},setTotalNotes(e){n.textContent=`${e} note${e>1?"s":""}`},getElement:()=>e,onClickDetail(t){e.querySelector(".tunkit_template_icon_detail").onclick=function(e){e.stopPropagation(),t()}},onClick(t){e.onclick=()=>t()}}}function f(e,t){t.onClickDetail((function(){const n=(0,o.getTemplateDialogComponent)();n.setName(c.default.TIMELINE_NOTE[e].name),n.setDescription(c.default.TIMELINE_NOTE[e].description),n.render();const i=(0,a.DialogWithOverlayFlow)(n.getElement(),{close_selector:[".tunkit_close_template"],overlay_z_index:2201});n.onClickSubmit((function(){r.default.from((0,s.getCurrentYoutubeId)()).update(e,{name:n.getName(),description:n.getDescription()}).then((l=>{"success"==l.status&&(c.default.TIMELINE_NOTE[e].name=n.getName(),c.default.TIMELINE_NOTE[e].description=n.getDescription(),t.setName(n.getName()),c.default.CURRENT_TEMPLATE_ID==e&&(0,_.setCurrentTemplate)(n.getName()),i.removeOverlay(),i.removeDialog())}))})),n.onClickDelete((()=>{c.default.CURRENT_TEMPLATE_ID!=e?confirm("Are you sure you want to delete this template?")&&r.default.from((0,s.getCurrentYoutubeId)()).remove(e).then((n=>{"success"==n.status&&(delete c.default.TIMELINE_NOTE[e],i.removeOverlay(),i.removeDialog(),t.getElement().remove())})):alert("Please select another template before deleting")}))})),t.onClick((function(){var n,i,l;c.default.CURRENT_TEMPLATE_ID!=e&&(c.default.CURRENT_TEMPLATE_ID=e,(0,u.removeAllInteractionElements)(),(0,d.activeTimelineInVideo)((0,_.getStateActiveTimelineInVideo)()),(0,m.resetPanelScore)(),null===(l=null===(i=null===(n=c.default.TEMPLATE_PANEL_WRAPPER)||void 0===n?void 0:n.querySelector(".tunkit_template_panel_item_selected"))||void 0===i?void 0:i.classList)||void 0===l||l.remove("tunkit_template_panel_item_selected"),t.getElement().classList.add("tunkit_template_panel_item_selected"),(0,_.setCurrentTemplate)(c.default.TIMELINE_NOTE[e].name),(0,_.setCurrentTotalNotes)(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),(0,_.showPanel)(".tunkit_panel.panel_main","tunkit_panel_active"),(0,_.setDisableItems)(c.default.PANEL_WRAPPER,".tunkit_disable_for_template",!1),(0,_.setCurrentTotalNotes)(Object.keys(c.default.TIMELINE_NOTE[e].timelineNotes).length),c.default.IS_GET_TIMELINE=!1)}))}},851:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleLoadTimeline=function(){var e;const t=null===(e=_.default.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector("#tunkit_loader.loader_note");t.style.display="block",_.default.TIMELINE_PANEL_WRAPPER.innerHTML="";const n=_.default.TIMELINE_NOTE[_.default.CURRENT_TEMPLATE_ID].timelineNotes;Object.keys(n).forEach((e=>{const t=f();t.setName(n[e].name),t.setTimelineText(n[e].startTime,n[e].endTime),t.setType(n[e].type),t.onClick((()=>p(e,t))),t.render()})),t.style.display="none"},t.getTimelinePanelItem=f,t.handleClickTimelineItemPanel=p;const l=n(996),o=n(122),a=n(195),r=n(28),u=i(n(103)),s=n(500),c=n(790),d=n(666),_=i(n(934)),m=n(420),E=n(221);function f(){const e=(0,d.getComponent)(".tunkit_timeline_panel_item",!1),t=e.querySelector(".timeline_panel_item_time_text"),n=e.querySelector(".timeline_panel_item_name"),i=e.querySelector(".timeline_panel_item_type");return{render(){var t;null===(t=_.default.TIMELINE_PANEL_WRAPPER)||void 0===t||t.appendChild(e)},setTimelineText(n,i){const l=(0,d.getTimelineTextFormat)(n,i);e.querySelector(".timeline_panel_item_time_text").onclick=function(e){e.stopPropagation(),_.default.VIDEO.currentTime=n},t.textContent=l},setName(e){n.textContent=e},setType(e){i.textContent=u.default.GETNAME[e]},onClick(t){e.onclick=()=>t()},getElement:()=>e}}function p(e,t){const n=_.default.TIMELINE_NOTE[_.default.CURRENT_TEMPLATE_ID].timelineNotes[e],i=(0,c.DialogTimelineTypeNavigator)(n.type);i.BASE.setTitle(`Update ${n.type} timeline`),i.BASE.setName(n.name),i.BASE.setStartTime(n.startTime),i.BASE.setEndTime(n.endTime),i.BASE.INPUT_TAG.setData(n.tags);const f=(0,a.DialogWithOverlayFlow)(i.BASE.getElement(),{close_selector:[".tunkit_close_timeline"],overlay_z_index:2201});let p={};switch(n.type){case"message":case"flashcard":p=function(e,t){e.setDataTimeline(t.data);const n=JSON.parse(JSON.stringify(t.action));return(0,l.ButtonAdderWithDialogActionFlow)(n,e),function(){return{data:e.getDataTimeline(),action:n,type:t.type}}}(i,n);break;case"typing":p=function(e,t){e.setDataTimeline(t.data.question);const n=JSON.parse(JSON.stringify(t.action));return(0,r.InputTagSelectWithDialogFlow)(n,e),function(){return{data:{question:e.getDataTimeline()},action:n,type:"typing"}}}(i,n);break;case"pointer":p=function(e,t){const n=JSON.parse(JSON.stringify(t.action));return(0,o.ButtonAdderWithPointerDialogActionFlow)(n,e),function(){return{data:{},action:n,type:"pointer"}}}(i,n)}i.render(),i.BASE.onClickDelete((function(){confirm("Are you sure to delete this timeline note?")&&u.default.from((0,d.getCurrentYoutubeId)()).withTemplate(_.default.CURRENT_TEMPLATE_ID).remove(e).then((n=>{"success"==n.status&&(delete _.default.TIMELINE_NOTE[_.default.CURRENT_TEMPLATE_ID].timelineNotes[e],t.getElement().remove(),_.default.IS_GET_TEMPLATE=!1,(0,E.setCurrentTotalNotes)(Object.keys(_.default.TIMELINE_NOTE[_.default.CURRENT_TEMPLATE_ID].timelineNotes).length),f.removeDialog(),f.removeOverlay(),(0,s.removeAllInteractionElements)(),(0,m.activeTimelineInVideo)((0,E.getStateActiveTimelineInVideo)()))}))})),i.BASE.onClickSave((function(){let n={name:i.BASE.getName(),startTime:i.BASE.getStartTime(),endTime:i.BASE.getEndTime(),tags:i.BASE.INPUT_TAG.getData(),data:"nothing",action:{},type:"message",timeline:(0,d.getTimelineTextFormat)(i.BASE.getStartTime(),i.BASE.getEndTime())};const l=Object.assign(Object.assign({},n),p());if("typing"==l.type){const e=l.action,t=Object.keys(e).find((t=>"otherwise"==e[t].select_type));if(!t)return void alert('It must have one "otherwise" action.');e[t].include=[]}u.default.from((0,d.getCurrentYoutubeId)()).withTemplate(_.default.CURRENT_TEMPLATE_ID).update(e,l).then((n=>{"success"==n.status&&(t.setTimelineText(l.startTime,l.endTime),t.setName(l.name),_.default.TIMELINE_NOTE[_.default.CURRENT_TEMPLATE_ID].timelineNotes[e]=l,f.removeDialog(),f.removeOverlay(),(0,s.removeAllInteractionElements)(),(0,m.activeTimelineInVideo)((0,E.getStateActiveTimelineInVideo)()))}))}))}},145:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.setSegmentScore=function(){const e=Object.keys(l.default.TEMP_SCORE_DATA.timeline).length;l.default.SEGMENT_CORRECT_PANEL.style.width=l.default.TEMP_SCORE_DATA.current_correct/e*100+"%",l.default.SEGMENT_INCORRECT_PANEL.style.width=l.default.TEMP_SCORE_DATA.current_incorrect/e*100+"%",l.default.TRACK_SCORE.innerText=`${l.default.TEMP_SCORE_DATA.current_correct+l.default.TEMP_SCORE_DATA.current_incorrect}/${e}`},t.resetPanelScore=function(){o(),l.default.SEGMENT_CORRECT_PANEL.style.width="0%",l.default.SEGMENT_INCORRECT_PANEL.style.width="0%",l.default.TRACK_SCORE.innerText=`0/${Object.keys(l.default.TEMP_SCORE_DATA.timeline).length}`},t.resetScoreData=o;const l=i(n(934));function o(){l.default.TEMP_SCORE_DATA={current_correct:0,current_incorrect:0,timeline:{}},Object.entries(l.default.TIMELINE_NOTE[l.default.CURRENT_TEMPLATE_ID].timelineNotes).forEach((([e,t])=>{let n=!1;Object.entries(t.action).forEach((([t,i])=>{"mark_correct"!=i.type&&"mark_incorrect"!=i.type||(n=!0,l.default.TEMP_SCORE_DATA.timeline[e]||(l.default.TEMP_SCORE_DATA.timeline[e]={data:[],is_executed:!1}),l.default.TEMP_SCORE_DATA.timeline[e].data.push({action_id:t,type:i.type}))}))}))}},666:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._getURL=function(e){return chrome.runtime.getURL(`assets/${e}`)},t.getComponent=function(e,t=!0){const n=l.component_wrapper.querySelector(`${e}`);if(null==n)throw new Error("Can't find component");const i=n.cloneNode(!0);return 1==t&&n.remove(),i},t.randomString=function(){return"_"+(Date.now()+Math.random()+1).toString(36).replaceAll(".","")},t.getCurrentYoutubeId=function(){const e=new URLSearchParams(window.location.search).get("v");if(null==e)throw new Error("Can't get youtubeID");return e},t.getTitleYoutube=function(){var e;const t=null===(e=document.querySelector("#title > h1 > yt-formatted-string"))||void 0===e?void 0:e.textContent;if(null==t)throw new Error("Can't get youtube title");return t},t.HmsToSeconds=function(e){let t=e.split(":");return 3!=t.length?60*parseInt(t[0])+parseInt(t[1]):3600*parseInt(t[0])+60*parseInt(t[1])+parseInt(t[2])},t.secondsToHms=a,t.insertAdjacentElement=function(e,t,n){const i=e.querySelector(n);if(null==i)throw new Error("The element does not exists");i.insertAdjacentElement("afterend",t)},t.getTimelineTextFormat=function(e,t){return`${a(String(e))}  ${a(String(t))}`},t.isForcePauseVideo=function(e,t){o.default.VIDEO[e?"addEventListener":"removeEventListener"]("playing",r),t&&(o.default.VIDEO.currentTime=t)};const l=n(433),o=i(n(934));function a(e){let t=parseInt(e,10),n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60),l=t-3600*n-60*i;return n<10?n="0"+n+":":n+=":",i<10&&(i="0"+i),l<10&&(l="0"+l),n+i+":"+l}function r(){o.default.VIDEO.pause()}},934:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.initAfterInsertComponent=function(){var e;if(l.PANEL_WRAPPER=(0,i.getComponent)(".tunkit_panel_wrapper"),l.TEMPLATE_PANEL_WRAPPER=null===(e=l.PANEL_WRAPPER)||void 0===e?void 0:e.querySelector(".tunkit_template_wrapper"),l.TIMELINE_PANEL_WRAPPER=l.PANEL_WRAPPER.querySelector(".tunkit_body_note"),l.FULL_OVERLAY_WRAPPER.className="tunkit_overlay_wrapper",document.body.insertAdjacentElement("afterend",l.FULL_OVERLAY_WRAPPER),l.FULL_OVERLAY.className="tunkit_overlay opened",l.FULL_OVERLAY.style.zIndex="2201",l.DIALOG_WRAPPER.className="tunkit_dialog_wrapper",document.body.insertAdjacentElement("afterend",l.DIALOG_WRAPPER),l.VIDEO=document.querySelector("video"),null==l.VIDEO)throw new Error("Can not find video element");if(l.VIDEO_PLAYER=document.querySelector(".html5-video-player"),null==l.VIDEO_PLAYER)throw new Error("Can not find video player element");l.TRACK_PANEL_ITEM_WRAPPER=l.PANEL_WRAPPER.querySelector(".tunkit_track_note_wrapper"),l.SEGMENT_CORRECT_PANEL=l.PANEL_WRAPPER.querySelector(".tunkit_segment_correct"),l.SEGMENT_INCORRECT_PANEL=l.PANEL_WRAPPER.querySelector(".tunkit_segment_incorrect"),l.TRACK_SCORE=l.PANEL_WRAPPER.querySelector(".tunkit_track_score")};const i=n(666),l={PANEL_WRAPPER:null,IS_GET_TEMPLATE:!1,IS_GET_TIMELINE:!1,TEMPLATE_PANEL_WRAPPER:null,TIMELINE_PANEL_WRAPPER:null,FULL_OVERLAY_WRAPPER:document.createElement("div"),FULL_OVERLAY:document.createElement("tp-yt-iron-overlay-backdrop"),DIALOG_WRAPPER:document.createElement("div"),CURRENT_TEMPLATE_ID:null,TIMELINE_NOTE:{},VIDEO:null,TEMP_REFERENCE_ACTION_ELEMENT:null,VIDEO_PLAYER:null,SET_TIMEOUT_RECHECK_TIMELINE:[],DATA_TIMELINE_INTERFACE:null,TRACK_PANEL_ITEM_WRAPPER:null,PANEL_TRACK_ITEM:document.createElement("div"),SEGMENT_CORRECT_PANEL:null,SEGMENT_INCORRECT_PANEL:null,TRACK_SCORE:null,TEMP_SCORE_DATA:{}};t.default=l},420:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.initPointerVideo=function(e,t){var n,i,l,r,u,s;const c=e[t].axis,d=document.createElement("div");d.className="tunkit_pointer_wrapper";const _=document.createElement("div");_.className="tunkit_pointer_child",_.style.left=c.x+"%",_.style.top=c.y+"%",_.innerHTML=`<img src="${(0,o._getURL)("icons/pointer.svg")}" /> <span>Pointer</span>`,null===(n=a.default.VIDEO_PLAYER)||void 0===n||n.appendChild(_);let m=!1;document.querySelector("#below > ytd-watch-metadata").style.opacity="0.4",d.onmouseup=()=>m=!1,d.onmousedown=()=>m=!0,d.onmouseout=()=>m=!1;let E=c.x,f=c.y;d.addEventListener("mousemove",(e=>{if(!m)return;const t=d.getBoundingClientRect();let n=e.offsetX-36,i=e.offsetY-12;n<0&&(n=0),i<0&&(i=0),n+72>t.width&&(n=t.width-72),i+24>t.height&&(i=t.height-24),E=n/t.width*100,f=i/t.height*100,_.style.left=E+"%",_.style.top=f+"%"}));const p=document.createElement("div");p.className="tunkit_pointer_overlay";const T=document.createElement("div");function h(){var e;d.remove(),_.remove(),p.remove(),T.remove(),a.default.DIALOG_WRAPPER.style.display="initial",a.default.FULL_OVERLAY_WRAPPER.style.display="block",null===(e=a.default.PANEL_WRAPPER)||void 0===e||e.classList.add("tunkit_menu_active"),document.querySelector("#below > ytd-watch-metadata").style.opacity="1",window.removeEventListener("resize",v),window.removeEventListener("fullscreenchange",v)}function v(){_.style.left=E+"%",_.style.top=f+"%"}T.className="tunkit_pointer_buttons tunkit_flex_center",T.style.gap="1em",T.style.alignItems="baseline",T.innerHTML='\n    <button class="save_pointer_btn yt-spec-button-shape-next yt-spec-button-shape-next--filled yt-spec-button-shape-next--mono yt-spec-button-shape-next--size-m" style="margin: 0 auto; margin-bottom: 1em">Save</button>\n    <button style="background: #333;color: white;" class="cancel_pointer_btn yt-spec-button-shape-next yt-spec-button-shape-next--filled yt-spec-button-shape-next--mono yt-spec-button-shape-next--size-m" style="margin: 0 auto; margin-bottom: 1em">Cancel</button>\n    ',null===(i=T.querySelector(".cancel_pointer_btn"))||void 0===i||i.addEventListener("click",(()=>{h()})),null===(l=T.querySelector(".save_pointer_btn"))||void 0===l||l.addEventListener("click",(()=>{const n=_.style.left.replace("%","").replace("px",""),i=_.style.top.replace("%","").replace("px","");e[t].axis={x:n,y:i},h()})),null===(r=a.default.VIDEO_PLAYER)||void 0===r||r.appendChild(d),null===(u=a.default.VIDEO_PLAYER)||void 0===u||u.appendChild(p),null===(s=document.querySelector("#clarify-box"))||void 0===s||s.appendChild(T),window.addEventListener("resize",v),window.addEventListener("fullscreenchange",v)},t.activeTimelineInVideo=r,t.setDataInterface=s;const l=i(n(459)),o=n(666),a=i(n(934));function r(e){"set"==(null==e?void 0:e.data_timeline)&&s(),"clear"==(null==e?void 0:e.timeout)&&(a.default.SET_TIMEOUT_RECHECK_TIMELINE.forEach((e=>{clearTimeout(e)})),a.default.SET_TIMEOUT_RECHECK_TIMELINE=[]),(null==e?void 0:e.video)&&a.default.VIDEO["add"==e.video?"addEventListener":"removeEventListener"]("timeupdate",u),(null==e?void 0:e.playing)&&a.default.VIDEO["add"==e.playing?"addEventListener":"removeEventListener"]("playing",u)}function u(){if(console.log("i check"),!Array.isArray(a.default.DATA_TIMELINE_INTERFACE))throw new Error("There is some problem with timeline interface");const e=a.default.VIDEO.currentTime,t=a.default.DATA_TIMELINE_INTERFACE.find((t=>t.start<=e&&e<=t.end));if(null!=t)t.element.show(),r({video:"add"});else{a.default.DATA_TIMELINE_INTERFACE.map((e=>{e.element.hide()}));const e=a.default.DATA_TIMELINE_INTERFACE.reduce(((e,t)=>{const n=a.default.VIDEO.currentTime;return t.start>=n&&n<=t.end&&t.start<e.start?t:e}),{start:a.default.VIDEO.duration,end:-1});if(null!=e&&e.end>=0){const t=1e3*(e.start-a.default.VIDEO.currentTime-1);console.log("i will be active in ",t," millisecond"),r({timeout:"clear",video:"remove"}),a.default.SET_TIMEOUT_RECHECK_TIMELINE.push(setTimeout((()=>{r({video:"add"})}),t>0?t:0))}else r({video:"remove",timeout:"clear"})}}function s(){if("string"!=typeof a.default.CURRENT_TEMPLATE_ID)throw new Error("There is some problem when set timeline interface");a.default.DATA_TIMELINE_INTERFACE=[],Object.entries(a.default.TIMELINE_NOTE[a.default.CURRENT_TEMPLATE_ID].timelineNotes).forEach((([e,t])=>{const n=(0,l.default)(t.type,t);n.render(),a.default.DATA_TIMELINE_INTERFACE.push({start:t.startTime,end:t.endTime,element:n,timeline_id:e,timeline_data:t})}))}}},t={};!function n(i){var l=t[i];if(void 0!==l)return l.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(879)})();